# üü° - Alpine.js Pur

:::warning A prendre en compte imm√©diatement
**Parcours Alpine.js ( _Plus avanc√© que Livewire_ üü° )**<br />
**Alpine.js** = _R√©activit√© c√¥t√© client_
:::

:::note
_Pour cette partie et apprendre √† utiliser Alpine.js, **vous pouvez recr√©er un projet** avec **tasks-alpine** comme nom._<br />
_Nous ne le ferons pas ici, mais c'est tout √† fait louable et surtout, √ßa vous fera pratiquer ce qui a d√©j√† √©t√© vu auparavant._
:::

## **Qu'est-ce qu'Alpine.js ?**

**Alpine.js** est un **framework JavaScript minimaliste** qui apporte la r√©activit√© directement dans le HTML sans la complexit√© de frameworks
lourds comme React ou Vue.js. Il constitue une alternative moderne pour cr√©er des interfaces interactives tout en conservant la simplicit√©
d'utilisation.

**Voici ses principes cl√©s :**

-   **L√©ger et performant** : _Seulement **~15KB minifi√©**, id√©al pour les performances._
-   **D√©claratif** : _Logique directement int√©gr√©e dans le **HTML** avec une syntaxe **intuitive**._
-   **R√©actif** : _Mises √† jour automatiques de l'interface utilisateur c√¥t√© client._
-   **Sans compilation** : _Fonctionnement direct dans le navigateur sans √©tape de build._

## **√âvolution Naturelle**

```mermaid
---
title: Progression & Prochaines √âtapes
config:
  theme: 'neutral'
---
graph TB
A[<b>Application Laravel</b>] -.-> |Challenge| B["Interactions basiques"]
C[<b>Solution Alpine.js</b>] -.-> |Apporte|D[R√©activit√© client] --> |Permet| E[Interactions riches] -.-> |Offre| F[UX moderne]

style A fill:#e3e3f3
style C fill:#e3e3f3
style F fill:#e3f3e3
```

_Maintenant que nous ma√Ætrisons Laravel classique, nous allons ajouter Alpine.js pour cr√©er des interactions fluides c√¥t√© client. Cette
approche n√©cessite une architecture diff√©rente de Livewire, car la logique s'ex√©cute enti√®rement dans le navigateur et communique avec le
serveur via des API REST._

## **Diff√©rence Fondamentale avec Livewire**

### Architecture Comparative

L'approche Alpine.js diff√®re radicalement de Livewire dans sa philosophie d'ex√©cution. Cette diff√©rence architecturale influence
directement la mani√®re dont nous structurons notre application.

**Livewire - Approche Serveur**

-   Logique m√©tier ex√©cut√©e c√¥t√© serveur
-   Communication via requ√™tes AJAX automatiques
-   Validation et s√©curit√© int√©gr√©es c√¥t√© serveur
-   Pas d'API REST n√©cessaire

**Alpine.js - Approche Client**

-   Logique m√©tier ex√©cut√©e c√¥t√© client
-   Communication via API REST explicite
-   Validation c√¥t√© client ET serveur
-   N√©cessite la cr√©ation d'endpoints API

### Diagramme Architectural

```mermaid
---
config:
    theme: 'neutral'
---
flowchart LR
    subgraph Livewire["Livewire Architecture"]
        direction LR
        L1[Composant Livewire] -.-> L2[Requ√™tes AJAX]
        L2 -.-> L3[Serveur Laravel]
        L3 -.-> L4[Base de donn√©es]
    end

    subgraph Alpine["Alpine.js Architecture"]
        direction LR
        A1[Composant Alpine.js] -.-> A2[API REST]
        A2 -.-> A3[Contr√¥leur API]
        A3 -.-> A4[Base de donn√©es]
    end

    style Livewire fill:#e3e3f3
    style Alpine fill:#e3f3e3
```

Cette distinction architecturale n√©cessite de cr√©er une **API REST compl√®te** pour permettre la communication entre
le **frontend Alpine.js** et le **backend Laravel**.

## **Cr√©ation de l'API Laravel**

> La cr√©ation d'un contr√¥leur API d√©di√© constitue **la premi√®re √©tape** pour √©tablir la communication entre **Alpine.js** et **Laravel**.
> Ce contr√¥leur diff√®re des contr√¥leurs web classiques par sa sp√©cialisation dans les r√©ponses JSON.

### Contr√¥leur API

```bash
# Cr√©er le contr√¥leur API avec toutes les m√©thodes REST
php artisan make:controller Api/TaskController --api
```

:::info
Cette commande g√©n√®re automatiquement **un contr√¥leur optimis√© pour les API REST** avec les m√©thodes **index**, **store**, **show**,
**update** et **destroy** de pr√©-configur√©es.
:::

:::note Fichier cr√©√© automatiquement
Contr√¥leur API : **`app/Http/Controllers/Api/TaskController.php`**
:::

### Structure du contr√¥leur API

:::note Emplacement Fichier utilis√© ici
Contr√¥leur API : **`app/Http/Controllers/Api/TaskController.php`**
:::

```php
<?php

namespace App\Http\Controllers\Api;

use App\Http\Controllers\Controller;
use App\Models\Task;
use Illuminate\Http\Request;

class TaskController extends Controller
{
    // Toutes les m√©thodes API seront impl√©ment√©es ici
}
```

_Le contr√¥leur API h√©rite du contr√¥leur de base mais se sp√©cialise dans **la gestion des requ√™tes HTTP** et **la cr√©ation de r√©ponses JSON**
structur√©es pour la consommation par Alpine.js._

## **Impl√©mentation des M√©thodes API**

### M√©thode `index()`

_La m√©thode **`index()`** constitue le point d'entr√©e principal pour r√©cup√©rer la liste compl√®te des t√¢ches.
**Elle retourne les donn√©es au format JSON avec les codes de statut HTTP appropri√©s**._

```php
// R√©cup√©rer toutes les t√¢ches au format JSON
public function index()
{
    $tasks = Task::latest()->get();

    return response()->json([
        'data' => $tasks,
        'message' => 'T√¢ches r√©cup√©r√©es avec succ√®s'
    ], 200);

    // Sans message flash
    // return response()->json($tasks);
}
```

Cette m√©thode utilise la m√©thode **`latest()`** d'**Eloquent** ( _ORM - Object Relationnal Mapping_ ) pour trier les t√¢ches par
**date de cr√©ation d√©croissante**, garantissant que les t√¢ches les plus r√©centes apparaissent en premier dans l'interface utilisateur.

### M√©thode `store()`

_La m√©thode **`store()`** g√®re la cr√©ation de nouvelles t√¢ches via des **requ√™tes POST**.
**Elle int√®gre la validation des donn√©es** et retourne la t√¢che cr√©√©e avec un code de statut **HTTP 201**._

```php
// Cr√©er une nouvelle t√¢che via l'API REST
public function store(Request $request)
{
    $validated = $request->validate([
        'title' => 'required|min:3|max:255',
        'description' => 'nullable|max:500'
    ]);

    $task = Task::create($validated);

    return response()->json([
        'data' => $task,
        'message' => 'T√¢che cr√©√©e avec succ√®s'
    ], 201);

    // Sans message flash (qui pourrait √©nerv√© si c'est trop intrusif)
    // return response()->json($task, 201);
}
```

**La validation s'effectue c√¥t√© serveur** pour garantir la s√©curit√© et la coh√©rence des donn√©es, m√™me si **une validation pr√©liminaire** peut
√™tre impl√©ment√©e c√¥t√© client avec Alpine.js.

### M√©thode `update()`

_La m√©thode **`update()`** permet la modification des t√¢ches existantes via des **requ√™tes PUT**.
Elle utilise la liaison de mod√®le de Laravel pour r√©cup√©rer automatiquement la t√¢che √† modifier._

```php
// Mettre √† jour une t√¢che existante
public function update(Request $request, Task $task)
{
    $validated = $request->validate([
        'title' => 'required|min:3|max:255',
        'description' => 'nullable|max:500',
        'completed' => 'boolean'
    ]);

    $task->update($validated);

    return response()->json([
        'data' => $task->fresh(),
        'message' => 'T√¢che mise √† jour avec succ√®s'
    ], 200);

    // Sans message
    // return response()->json($task);
}
```

La m√©thode **`fresh()`** garantit que les donn√©es retourn√©es refl√®tent l'√©tat actuel de la t√¢che en base de donn√©es apr√®s la mise √† jour.

### M√©thode `destroy()`

_La m√©thode **`destroy()`** g√®re la suppression des t√¢ches via des **requ√™tes DELETE**.
Elle retourne un message de confirmation sans donn√©es suppl√©mentaires._

```php
// Supprimer une t√¢che d√©finitivement
public function destroy(Task $task)
{
    $task->delete();

    return response()->json([
        'message' => 'T√¢che supprim√©e avec succ√®s'
    ], 200);
}
```

### M√©thode `toggle()`

_La m√©thode **`toggle()`** repr√©sente une action personnalis√©e qui bascule l'√©tat de compl√©tion d'une t√¢che.
Elle illustre comment cr√©er des endpoints API sp√©cialis√©s au-del√† des op√©rations CRUD standard._

```php
// Basculer l'√©tat de compl√©tion d'une t√¢che
public function toggle(Task $task)
{
    $task->update(['completed' => !$task->completed]);

    return response()->json([
        'data' => $task->fresh(),
        'message' => '√âtat de la t√¢che modifi√© avec succ√®s'
    ], 200);

    // Sans message
    // return response()->json($task);
}
```

### M√©thode `stats()`

_La m√©thode **`stats()`** fournit des statistiques calcul√©es sur les t√¢ches.
Elle d√©montre comment cr√©er des endpoints API pour des donn√©es agr√©g√©es._

```php
// Calculer et retourner les statistiques des t√¢ches
public function stats()
{
    $total = Task::count();
    $completed = Task::where('completed', true)->count();
    $pending = Task::where('completed', false)->count();
    $completionRate = $total > 0 ? round(($completed / $total) * 100) : 0;

    return response()->json([
        'data' => [
            'total' => $total,
            'completed' => $completed,
            'pending' => $pending,
            'completion_rate' => $completionRate
        ],
        'message' => 'Statistiques calcul√©es avec succ√®s'
    ], 200);

    // Sans message
    // return response()->json([
    //     'total' => $total,
    //     'completed' => $completed,
    //     'pending' => $pending,
    //     'completion_rate' => $completionRate
    // ]);
}
```

Cette m√©thode utilise des **requ√™tes Eloquent** optimis√©es pour calculer efficacement les statistiques n√©cessaires
√† l'affichage du tableau de bord.

## **Configuration des Routes API**

### Structure des Routes REST

:::note Emplacement Fichier
**`routes/api.php`**
:::

```php
<?php

use App\Http\Controllers\Api\TaskController;
use Illuminate\Support\Facades\Route;

Route::prefix('tasks')->group(function () {
    Route::get('/', [TaskController::class, 'index']);                  // GET /api/tasks
    Route::post('/', [TaskController::class, 'store']);                 // POST /api/tasks
    Route::put('/{task}', [TaskController::class, 'update']);           // PUT /api/tasks/{id}
    Route::delete('/{task}', [TaskController::class, 'destroy']);       // DELETE /api/tasks/{id}
    Route::patch('/{task}/toggle', [TaskController::class, 'toggle']);  // PATCH /api/tasks/{id}/toggle
    Route::get('/stats', [TaskController::class, 'stats']);             // GET /api/tasks/stats
});
```

### Tableau de Correspondance des Routes

| M√©thode HTTP | Endpoint                   | Action  | Description                                        |
| :----------: | -------------------------- | :-----: | -------------------------------------------------- |
|   **GET**    | `/api/tasks`               |  index  | _R√©cup√©ration de toutes les t√¢ches._               |
|   **GET**    | `/api/tasks`               |  stats  | _R√©cup√©ration des statistiques._                   |
|   **POST**   | `/api/tasks/\{id\}`        |  store  | _Cr√©ation d'une nouvelle t√¢che._                   |
|   **PUT**    | `/api/tasks/\{id\}`        | update  | _Mise √† jour compl√®te d'une t√¢che._                |
|  **PATCH**   | `/api/tasks/\{id\}/toggle` | toggle  | _Basculement de l'√©tat de compl√©tion d'une t√¢che._ |
|  **DELETE**  | `/api/tasks/\{id\}`        | destroy | _Suppression d'une t√¢che._                         |

Cette structure respecte les conventions **REST** et facilite la compr√©hension et la maintenance de l'API.

## **Composant Alpine.js**

### Qu'est-ce qu'un Composant Alpine.js

:::info Fondamentaux pour comprendre la suite
Un **Composant Alpine.js** est une fonction JavaScript qui retourne un objet contenant l'√©tat r√©actif et les m√©thodes de votre composant.
Cette approche diff√®re des frameworks comme **React** ou **Vue**.js en privil√©giant la simplicit√© et l'int√©gration directe dans le HTML.
:::

#### Convention de nommage

_Les composants Alpine.js suivent une convention de nommage **fonctionnelle** qui facilite leur identification et leur utilisation
dans les **templates HTML**._

```javascript
// Fonction composant avec nommage descriptif
function taskManager() {
    return {
        // √âtat r√©actif - Propri√©t√©s observ√©es par Alpine.js
        tasks: [],
        loading: false,

        // M√©thodes - Actions disponibles pour l'interface
        async addTask() {
            /* Logique d'ajout de t√¢che */
        },

        async deleteTask(taskId) {
            /* Logique de suppression */
        },
    };
}
```

### Placement et Int√©gration

Le composant se place dans une balise **`<script>`** √† la **fin du document HTML**, apr√®s tout le contenu de l'interface utilisateur.
Cette approche **garantit que le DOM est enti√®rement charg√©** avant l'initialisation d'Alpine.js.

### Structure Compl√®te du composant

_La structure du composant Alpine.js refl√®te l'architecture de l'application et organise l'√©tat et les m√©thodes de mani√®re logique
et maintenable._

```javascript
function taskManager() {
    return {
        // √âtat des donn√©es - Propri√©t√©s r√©actives
        tasks: [],
        stats: {
            total: 0,
            completed: 0,
            pending: 0,
            completion_rate: 0,
        },
        form: {
            title: '',
            description: '',
        },
        editingTask: null,
        search: '',
        filter: 'all',
        loading: false,
        message: '',
        errors: {},

        // M√©thodes d'initialisation et gestion des donn√©es
        // Toutes les m√©thodes seront impl√©ment√©es ici
    };
}
```

:::warning Premier et dernier rappel
_Toutes les m√©thodes qui suivent doivent √™tre impl√©ment√©es dans l'objet retourn√© par la fonction **`taskManager()`**.<br />
Cette structure garantit que l'√©tat et les m√©thodes sont correctement encapsul√©s et accessibles par Alpine.js._
:::

### M√©thode `init()`

_La m√©thode **`init()`** constitue le point d'entr√©e du composant Alpine.js.
Elle s'ex√©cute automatiquement lors de l'initialisation du composant et configure l'√©tat initial de l'application._

```javascript
// Initialisation automatique du composant
async init() {
    await this.loadTasks();
    await this.loadStats();
},
```

Cette m√©thode utilise **la programmation asynchrone** ( _async & await_ ) pour charger les donn√©es initiales sans bloquer l'interface
utilisateur. L'ordre d'ex√©cution **garantit que les t√¢ches sont charg√©es avant le calcul des statistiques**.

### M√©thode `loadTasks()`

_La m√©thode **`loadTasks()`** r√©cup√®re la liste des t√¢ches depuis l'API REST.
Elle g√®re les erreurs de r√©seau et met √† jour l'√©tat du composant avec les donn√©es r√©cup√©r√©es.._

```javascript
// Chargement des t√¢ches depuis l'API REST
async loadTasks() {
    try {
        this.loading = true;
        const response = await fetch('/api/tasks');

        if (!response.ok) {
            throw new Error('Erreur lors du chargement des t√¢ches');
        }

        const loadingData = await response.json();
        this.tasks = loadingData.data || [];
    } catch (error) {
        console.error('Erreur:', error);
        this.showMessage('Erreur lors du chargement des t√¢ches', 'error');
    } finally {
        this.loading = false;
    }
},
```

La gestion des erreurs inclut la v√©rification du statut HTTP et la capture des exceptions r√©seau pour fournir un feedback
appropri√© √† l'utilisateur.

### M√©thode `loadStats()`

_La m√©thode **`loadStats()`** r√©cup√®re les statistiques calcul√©es depuis l'API et met √† jour l'affichage du tableau de bord._

```javascript
// Chargement des statistiques depuis l'API
async loadStats() {
    try {
        const response = await fetch('/api/tasks/stats');

        if (!response.ok) {
            throw new Error('Erreur lors du chargement des statistiques');
        }

        const statsData = await response.json();
        this.stats = statsData.data || {};
    } catch (error) {
        console.error('Erreur lors du chargement des statistiques:', error);
        // Les statistiques ne sont pas critiques, on continue sans message d'erreur
    }
},
```

### M√©thode `addTask()`

_La m√©thode **`addTask()`** g√®re la cr√©ation de nouvelles t√¢ches via l'API REST.
Elle inclut la validation c√¥t√© client et la gestion des erreurs serveur._

```javascript


        if (response.ok) {

        } else {
            const errors = await response.json();
            this.errors = errors.errors || {};
        }


// Ajouter une t√¢che via l'API REST
async addTask() {
    // Validation c√¥t√© client avant envoi
    if (!this.form.title.trim()) {
        this.errors.title = 'Le titre est obligatoire';
        return;
    }

    // Initialisation de l'√©tat de chargement
    this.loading = true;
    this.errors = {};

    try {
        const response = await fetch('/api/tasks', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            },
            body: JSON.stringify(this.form)
        });

        if (response.ok) {
            // Traitement de la r√©ponse avec structure data
            const newTask = await response.json();

            // Mise √† jour optimiste de l'interface
            this.tasks.unshift(newTask);
            this.resetForm();
            this.showMessage('T√¢che ajout√©e avec succ√®s !');

            // Rechargement des statistiques
            await this.loadStats();
        } else {
            // Gestion des erreurs de validation serveur
            const errorData = await response.json();
            this.errors = errorData.errors || {};
        }
    } catch (error) {
        console.error('Erreur lors de l\'ajout:', error);
        this.showMessage('Erreur lors de l\'ajout de la t√¢che', 'error');
    } finally {
        this.loading = false;
    }
}
```

Cette m√©thode illustre la gestion compl√®te d'une requ√™te API avec validation c√¥t√© client, traitement des r√©ponses structur√©es
et mise √† jour optimiste de l'interface utilisateur.

### M√©thode `updateTask()`

_La m√©thode **`updateTask()`** g√®re la modification des t√¢ches existantes.
Elle suit le m√™me pattern de traitement des r√©ponses JSON structur√©es que la m√©thode **`addTask()`**._

```javascript
// Modifier une t√¢che existante via l'API REST
async updateTask() {
    // Validation pr√©alable des donn√©es
    if (!this.form.title.trim()) {
        this.errors.title = 'Le titre est obligatoire';
        return;
    }

    this.loading = true;
    this.errors = {};

    try {
        const response = await fetch(`/api/tasks/${this.editingTask.id}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            },
            body: JSON.stringify(this.form)
        });

        if (response.ok) {
            // Extraction des donn√©es de la r√©ponse structur√©e
            const updatedTask = await response.json();

            // Mise √† jour locale de la t√¢che modifi√©e
            const taskIndex = this.tasks.findIndex(task => task.id === updatedTask.id);
            if (taskIndex  !== -1) {
                this.tasks[taskIndex] = updatedTask;
            }

            // R√©initialisation du mode √©dition
            this.cancelEdit();
            this.showMessage('T√¢che mise √† jour !');

            // Actualisation des statistiques
            await this.loadStats();
        } else {
            // Traitement des erreurs de validation
            const errors = await response.json();
            this.errors = errors.errors || {};
        }
    } catch (error) {
        console.error('Erreur lors de la mise √† jour:', error);
        this.showMessage('Erreur lors de la mise √† jour', 'error');
    } finally {
        this.loading = false;
    }
},
```

### M√©thode `toggleTask()`

_La m√©thode **`toggleTask()`** bascule l'√©tat de compl√©tion d'une t√¢che via l'endpoint API sp√©cialis√©.
Elle traite la r√©ponse JSON structur√©e pour mettre √† jour l'interface utilisateur._

```javascript
// Basculer l'√©tat de compl√©tion d'une t√¢che
async toggleTask(task) {
    this.loading = true;

    try {
        const response = await fetch(`/api/tasks/${task.id}/toggle`, {
            method: 'PATCH',
            headers: {
                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            }
        });

        if (response.ok) {
            // Traitement de la r√©ponse avec extraction des donn√©es
            const updatedTask = await response.json();

            // Localisation et mise √† jour de la t√¢che dans la liste
            const taskIndex = this.tasks.findIndex(taskDB => taskDB.id === task.id);
            if (taskIndex !== -1) {
                this.tasks[taskIndex] = updatedTask;
            }
            this.showMessage('T√¢che mise √† jour !');

            // Recalcul des statistiques apr√®s modification
            await this.loadStats();
        } else {
            throw new Error('Erreur lors du basculement de l\'√©tat');
        }
    } catch (error) {
        console.error('Erreur lors du basculement:', error);
        this.showMessage('Erreur lors de la mise √† jour', 'error');
    } finally {
        this.loading = false;
    }
},
```

### M√©thode `deleteTask()`

_La m√©thode **`deleteTask()`** g√®re la suppression des t√¢ches avec confirmation utilisateur.
Elle traite la r√©ponse de suppression et met √† jour l'interface de mani√®re optimiste.._

```javascript
// Supprimer une t√¢che avec confirmation utilisateur
async deleteTask(task) {
    // Demande de confirmation avant suppression
    if (!confirm('√ätes-vous s√ªr de vouloir supprimer cette t√¢che ?')) {
        return;
    }

    this.loading = true;

    try {
        const response = await fetch(`/api/tasks/${task.id}`, {
            method: 'DELETE',
            headers: {
                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            }
        });

        if (response.ok) {
            // La suppression ne retourne que le message de confirmation
            const responseData = await response.json();

            // Suppression optimiste de la t√¢che de la liste locale
            this.tasks = this.tasks.filter(t => t.id !== task.id);

            this.showMessage('T√¢che supprim√©e avec succ√®s !');

            // Mise √† jour des statistiques apr√®s suppression
            await this.loadStats();
        } else {
            throw new Error('Erreur lors de la suppression');
        }
    } catch (error) {
        console.error('Erreur lors de la suppression:', error);
        this.showMessage('Erreur lors de la suppression', 'error');
    } finally {
        this.loading = false;
    }
},
```

## **M√©thodes Utilitaires et de Gestion d'√âtat**

_Ces m√©thodes g√®rent l'√©tat local du composant sans interaction avec l'API, maintenant la coh√©rence de l'exp√©rience utilisateur._

### M√©thode `editTask()`

_Permet de d√©marrer le mode √©dition d'une t√¢che._

```javascript
// Commencer l'√©dition
editTask(task) {
    this.editingTask = task;
    this.form = {
        title: task.title,
        description: task.description || ''
    };
    this.errors = {};
},
```

### M√©thode `cancelEdit()`

_Permet d'annuler le mode √©dition et r√©initialiser l'√©tat._

```javascript
// Annuler le mode √©dition et r√©initialiser l'√©tat
cancelEdit() {
    this.editingTask = null;
    this.resetForm();
},
```

### M√©thode `resetForm()`

_Permet de r√©initialiser le formulaire √† son √©tat initial._

```javascript
// R√©initialiser le formulaire √† son √©tat initial
resetForm() {
    this.form = {
        title: '',
        description: ''
    };
    this.errors = {};
},
```

### M√©thode `resetFilters()`

_Permet de r√©initialiser les filtres de recherche et de statut._

```javascript
// R√©initialiser les filtres de recherche et de statut
resetFilters() {
    this.search = '';
    this.filter = 'all';
},
```

### M√©thode `showMessage()`

_Permet d'afficher un message temporaire √† l'utilisateur._

```javascript
// Afficher un message temporaire √† l'utilisateur
showMessage(text, type = 'success') {
    this.message = text;
    setTimeout(() => {
        this.message = '';
    }, 3000);
},
```

### M√©thode `formatDate()`

_Permet de formater les dates pour l'affichage utilisateur._

```javascript
// Formater les dates pour l'affichage utilisateur
formatDate(dateString) {
    const date = new Date(dateString);
    const now = new Date();
    const timeDifference = now - date;
    const daysDifference = Math.floor(timeDifference / (1000 * 60 * 60 * 24));

    if (daysDifference === 0) return 'aujourd\'hui';
    if (daysDifference === 1) return 'hier';
    if (daysDifference < 7) return `il y a ${daysDifference} jours`;

    return date.toLocaleDateString('fr-FR');
}
```

### Propri√©t√© calcul√©e `filteredTasks`

_Cette propri√©t√© calcul√©e d√©montre la r√©activit√© d'Alpine.js en filtrant automatiquement les t√¢ches selon les crit√®res de recherche
et de statut._

```javascript
// Propri√©t√© calcul√©e pour le filtrage dynamique des t√¢ches
get filteredTasks() {
    let filteredResults = this.tasks;

    // Application du filtre de recherche textuelle
    if (this.search) {
        const searchTerm  = this.search.toLowerCase();
        filteredResults = filteredResults.filter(task =>
            const titleMatch = task.title.toLowerCase().includes(searchTerm);
            const descriptionMatch = task.description && task.description.toLowerCase().includes(searchTerm);
            return titleMatch || descriptionMatch
        );
    }

    // Application du filtre de statut
    if (this.filter === 'completed') {
        filteredResults = filteredResults.filter(task => task.completed);
    } else if (this.filter === 'pending') {
        filteredResults = filteredResults.filter(task => !task.completed);
    }

    return filteredResults;
}
```

## **Concepts Cl√©s Alpine.js**

### Architecture D√©clarative

Alpine.js privil√©gie une approche d√©clarative o√π la logique est exprim√©e directement dans le HTML via des directives sp√©cialis√©es.
Cette philosophie rapproche le comportement de la pr√©sentation pour une meilleure lisibilit√©.

### Directives Fondamentales

```mermaid
---
title: "Directives li√© √† l'initialisation"
config:
    theme: 'neutral'
---
graph LR
    A["Directives Alpine.js"] --> B[Initialisation]

    B --> B1["x-data"]
    B --> B2["x-init"]

    style A fill:#e3e3f3
    style B1 fill:#e3f3e3
    style B2 fill:#e3f3e3
```

```mermaid
---
title: 'Directives li√© aux Liaisons de Donn√©es'
config:
    theme: 'neutral'
---
graph LR
    A["Directives Alpine.js"] --> C[Liaison de Donn√©es]

    C --> C1["x-model"]
    C --> C2["x-text"]
    C --> C3["x-show"]

    style A fill:#e3e3f3
    style C1 fill:#e3f3e3
    style C2 fill:#e3f3e3
    style C3 fill:#e3f3e3
```

```mermaid
---
title: "Directives li√© aux Gestions d'√âv√©nements"
config:
    theme: 'neutral'
---
graph LR
    A["Directives Alpine.js"] --> D[Gestion d'√âv√©nements]

    D --> D1["@click"]
    D --> D2["@submit"]
    D --> D3["@keyup"]

    style A fill:#e3e3f3
    style D1 fill:#e3f3e3
    style D2 fill:#e3f3e3
    style D3 fill:#e3f3e3
```

```mermaid
---
title: 'Directives li√© aux rendus Conditionnels'
config:
    theme: 'neutral'
---
graph LR
    A["Directives Alpine.js"] --> E[Rendu Conditionnel]

    E --> E1["x-if"]
    E --> E2["x-for"]
    E --> E3[":class"]

    style A fill:#e3e3f3
    style E1 fill:#e3f3e3
    style E2 fill:#e3f3e3
    style E3 fill:#e3f3e3
```

```mermaid
---
title: 'Directives li√© aux Transitions'
config:
    theme: 'neutral'
---
graph LR
    A["Directives Alpine.js"] --> F[Transitions]

    F --> F1["x-transition"]
    F --> F2["x-transition:enter"]
    F --> F3["x-transition:leave"]

    style A fill:#e3e3f3
    style F1 fill:#e3f3e3
    style F2 fill:#e3f3e3
    style F3 fill:#e3f3e3
```

<br />

:::danger Urgent
Il est important de comprendre cette partie afin de pouvoir impl√©menter ce concept dans nos fichiers HTML.
:::

### 1. Initialisation du composant

> Les directives d'initialisation √©tablissent le contexte Alpine.js et configurent l'√©tat initial du composant.

```html
<!-- Initialisation du composant avec les donn√©es -->
<div x-data="taskManager()">
    <!-- Ex√©cution automatique lors de l'initialisation -->
    <div x-init="init()">
        <!-- Contenu du composant ici ... -->
    </div>
</div>
```

### 2. Liaison de donn√©es

```html
<!-- Liaison bidirectionnelle avec le mod√®le -->
<input x-model="form.title" type="text" placeholder="Titre de la t√¢che" />

<!-- Affichage de texte dynamique -->
<h3 x-text="task.title"></h3>

<!-- Affichage conditionnel -->
<div x-show="loading">Chargement en cours...</div>
```

### 3. Gestion d'√©v√©nements

> Les directives d'√©v√©nements connectent les interactions utilisateur aux m√©thodes du composant.

```html
<!-- Gestion du clic sur un bouton -->
<button @click="addTask()">Ajouter une t√¢che</button>

<!-- Soumission de formulaire avec une pr√©vention du comportement par d√©faut -->
<form @submit.prevent="addTask()">
    <!-- Contenu du formulaire -->
</form>

<!-- Gestion des √©v√©nements clavier -->
<input @keyup.enter="addTask()" type="text" />
```

### 4. Rendu de Listes et Conditions

> Les directives de rendu g√®rent l'affichage dynamique du contenu selon l'√©tat de l'application.

```html
<!-- Rendu de liste avec cl√© unique -->
<template x-for="task in filteredTasks" :key="task.id">
    <div x-text="task.title"></div>
</template>

<!-- Classes conditionnelles -->
<div :class="{ 'completed': task.completed, 'pending': !task.completed }">
    <!-- Contenu de la t√¢che -->
</div>

<!-- Attributs dynamiques -->
<button :disabled="loading">Action</button>
```

### 5. Transitions et Animations

> Les directives de transition cr√©ent des animations fluides lors des changements d'√©tat.

```html
<!-- Transition d'entr√©e -->
x-transition:enter="transition ease-out duration-300"
x-transition:enter-start="opacity-0 transform translate-y-2"
x-transition:enter-end="opacity-100 transform translate-y-0"

<!-- Transition d'entr√©e & de sortie -->
<div
    x-show="message"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0 transform translate-y-2"
    x-transition:enter-end="opacity-100 transform translate-y-0"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100 transform translate-y-0"
    x-transition:leave-end="opacity-0 transform translate-y-2"
>
    Message affich√©
</div>
```

## **Vue Alpine.js Compl√®te**

### Structure HTML avec Int√©gration Alpine.js

> L'interface utilisateur int√®gre toutes les directives Alpine.js dans une structure HTML s√©mantique et accessible.

:::note Emplacement Fichier
**`resources/views/alpine-tasks.blade.php`**
:::

```html
<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>TALL Tasks - Alpine.js</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script
            defer
            src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
        ></script>
        <meta name="csrf-token" content="{{ csrf_token() }}" />
    </head>
    <body class="bg-gray-100">
        <div class="min-h-screen">
            <!-- En-t√™te de l'application -->
            <header class="bg-white shadow-sm border-b">
                <div class="max-w-4xl mx-auto px-6 py-4">
                    <div class="flex items-center justify-between">
                        <h1 class="text-2xl font-bold text-gray-800">
                            TALL Tasks
                        </h1>
                        <div class="flex items-center space-x-2">
                            <span
                                class="px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm"
                                >Tailwind ‚úì</span
                            >
                            <span
                                class="px-2 py-1 bg-green-100 text-green-800 rounded text-sm"
                                >Alpine.js ‚úì</span
                            >
                            <span
                                class="px-2 py-1 bg-red-100 text-red-800 rounded text-sm"
                                >Laravel API ‚úì</span
                            >
                        </div>
                    </div>
                    <div class="mt-2 text-sm text-gray-600">
                        √âtape 3:
                        <span class="text-green-600 font-medium"
                            >R√©activit√© Alpine.js üèîÔ∏è</span
                        >
                    </div>
                </div>
            </header>

            <!-- Application principale avec Alpine.js -->
            <main class="py-8" x-data="taskManager()" x-init="init()">
                <div class="max-w-4xl mx-auto px-6">
                    <!-- Messages utilisateur -->
                    <div
                        x-show="message"
                        x-transition:enter="transition ease-out duration-300"
                        x-transition:enter-start="opacity-0 transform translate-y-2"
                        x-transition:enter-end="opacity-100 transform translate-y-0"
                        x-transition:leave="transition ease-in duration-150"
                        x-transition:leave-start="opacity-100 transform translate-y-0"
                        x-transition:leave-end="opacity-0 transform translate-y-2"
                        class="mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg"
                    >
                        <div class="flex items-center justify-between">
                            <span x-text="message"></span>
                            <button
                                @click="message = ''"
                                class="text-green-500 hover:text-green-700"
                            >
                                &times;
                            </button>
                        </div>
                    </div>

                    <!-- Banni√®re informative Alpine.js -->
                    <div
                        class="mb-6 p-4 bg-green-50 border-l-4 border-green-400"
                    >
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <span class="text-green-600">üèîÔ∏è</span>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-green-700">
                                    <strong>Alpine.js en action :</strong>
                                    Toutes les interactions se font c√¥t√© client
                                    avec des appels API !
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Tableau de bord des statistiques -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-white p-4 rounded-lg shadow text-center">
                            <div
                                class="text-2xl font-bold text-blue-600"
                                x-text="stats.total"
                            ></div>
                            <div class="text-gray-600">Total</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow text-center">
                            <div
                                class="text-2xl font-bold text-green-600"
                                x-text="stats.completed"
                            ></div>
                            <div class="text-gray-600">Termin√©es</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow text-center">
                            <div
                                class="text-2xl font-bold text-yellow-600"
                                x-text="stats.pending"
                            ></div>
                            <div class="text-gray-600">En cours</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow text-center">
                            <div
                                class="text-2xl font-bold text-purple-600"
                                x-text="stats.completion_rate + '%'"
                            ></div>
                            <div class="text-gray-600">Progression</div>
                        </div>
                    </div>

                    <!-- Recherche et filtres -->
                    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                        <h2 class="text-xl font-semibold mb-4">
                            üîç Recherche et filtres
                        </h2>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <!-- Recherche -->
                            <div>
                                <label
                                    class="block text-sm font-medium text-gray-700 mb-2"
                                    >Rechercher</label
                                >
                                <input
                                    type="text"
                                    x-model="search"
                                    class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                    placeholder="Rechercher une t√¢che..."
                                />
                            </div>

                            <!-- Filtre -->
                            <div>
                                <label
                                    class="block text-sm font-medium text-gray-700 mb-2"
                                    >Filtrer</label
                                >
                                <select
                                    x-model="filter"
                                    class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                >
                                    <option value="all">
                                        Toutes les t√¢ches
                                    </option>
                                    <option value="pending">En cours</option>
                                    <option value="completed">Termin√©es</option>
                                </select>
                            </div>

                            <!-- Bouton reset -->
                            <div class="flex items-end">
                                <button
                                    @click="resetFilters()"
                                    class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors"
                                >
                                    üîÑ R√©initialiser
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Formulaire d'ajout/√©dition -->
                    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                        <h2 class="text-xl font-semibold mb-4">
                            <span
                                x-text="editingTask ? '‚úèÔ∏è Modifier la t√¢che' : '‚ûï Ajouter une t√¢che'"
                            ></span>
                        </h2>

                        <form
                            @submit.prevent="editingTask ? updateTask() : addTask()"
                        >
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <!-- Titre -->
                                <div>
                                    <label
                                        class="block text-sm font-medium text-gray-700 mb-2"
                                        >Titre *</label
                                    >
                                    <input
                                        type="text"
                                        x-model="form.title"
                                        class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                        :class="{'border-red-500': errors.title}"
                                        placeholder="Ex: Terminer le projet"
                                        required
                                    />
                                    <p
                                        x-show="errors.title"
                                        x-text="errors.title"
                                        class="mt-1 text-sm text-red-600"
                                    ></p>
                                </div>

                                <!-- Description -->
                                <div>
                                    <label
                                        class="block text-sm font-medium text-gray-700 mb-2"
                                        >Description</label
                                    >
                                    <input
                                        type="text"
                                        x-model="form.description"
                                        class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                        :class="{'border-red-500': errors.description}"
                                        placeholder="D√©tails optionnels..."
                                    />
                                    <p
                                        x-show="errors.description"
                                        x-text="errors.description"
                                        class="mt-1 text-sm text-red-600"
                                    ></p>
                                </div>
                            </div>

                            <!-- Boutons d'action -->
                            <div class="mt-4 flex gap-2">
                                <button
                                    type="submit"
                                    :disabled="loading"
                                    class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50"
                                >
                                    <span
                                        x-show="!loading"
                                        x-text="editingTask ? 'üíæ Mettre √† jour' : '‚ú® Ajouter'"
                                    ></span>
                                    <span x-show="loading"
                                        >‚è≥ Traitement...</span
                                    >
                                </button>

                                <button
                                    type="button"
                                    x-show="editingTask"
                                    @click="cancelEdit()"
                                    class="px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors"
                                >
                                    ‚ùå Annuler
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Liste des t√¢ches -->
                    <div class="bg-white rounded-lg shadow-md">
                        <div class="p-4 border-b">
                            <h2 class="text-xl font-semibold">
                                üìã Mes T√¢ches (<span
                                    x-text="filteredTasks.length"
                                ></span
                                >)
                            </h2>
                        </div>

                        <template x-for="task in filteredTasks" :key="task.id">
                            <div
                                class="p-4 border-b last:border-b-0 hover:bg-gray-50 transition-colors"
                            >
                                <div class="flex items-center justify-between">
                                    <!-- Informations de la t√¢che -->
                                    <div class="flex-1">
                                        <h3
                                            class="font-medium"
                                            :class="task.completed ? 'line-through text-gray-500' : 'text-gray-800'"
                                            x-text="task.title"
                                        ></h3>
                                        <p
                                            x-show="task.description"
                                            class="text-sm text-gray-600 mt-1"
                                            :class="task.completed ? 'line-through' : ''"
                                            x-text="task.description"
                                        ></p>
                                        <p
                                            class="text-xs text-gray-400 mt-2"
                                            x-text="'Cr√©√©e ' + formatDate(task.created_at)"
                                        ></p>
                                    </div>

                                    <!-- Actions -->
                                    <div class="flex items-center gap-2 ml-4">
                                        <!-- Toggle -->
                                        <button
                                            @click="toggleTask(task)"
                                            :disabled="loading"
                                            class="p-2 rounded-lg transition-colors"
                                            :class="task.completed ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-700 hover:bg-green-100'"
                                        >
                                            <span
                                                x-text="task.completed ? '‚úÖ' : '‚è≥'"
                                            ></span>
                                        </button>

                                        <!-- √âdition -->
                                        <button
                                            @click="editTask(task)"
                                            class="p-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors"
                                        >
                                            ‚úèÔ∏è
                                        </button>

                                        <!-- Suppression -->
                                        <button
                                            @click="deleteTask(task)"
                                            :disabled="loading"
                                            class="p-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors"
                                        >
                                            üóëÔ∏è
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Message si aucune t√¢che -->
                        <div
                            x-show="filteredTasks.length === 0"
                            class="p-8 text-center text-gray-500"
                        >
                            <div class="text-4xl mb-4">üìù</div>
                            <p>Aucune t√¢che trouv√©e.</p>
                            <button
                                x-show="search || filter !== 'all'"
                                @click="resetFilters()"
                                class="mt-2 text-blue-600 hover:text-blue-800"
                            >
                                R√©initialiser les filtres
                            </button>
                        </div>
                    </div>

                    <!-- D√©monstration des fonctionnalit√©s Alpine.js -->
                    <div class="mt-6 p-4 bg-blue-50 border-l-4 border-blue-400">
                        <h3 class="font-medium text-blue-800 mb-2">
                            üîß Fonctionnalit√©s Alpine.js d√©montr√©es :
                        </h3>
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>
                                ‚Ä¢ <strong>x-data</strong> : Gestion d'√©tat
                                r√©active
                            </li>
                            <li>
                                ‚Ä¢ <strong>x-init</strong> : Initialisation
                                automatique
                            </li>
                            <li>
                                ‚Ä¢ <strong>x-model</strong> : Liaison
                                bidirectionnelle
                            </li>
                            <li>
                                ‚Ä¢ <strong>x-show/x-text</strong> : Affichage
                                conditionnel
                            </li>
                            <li>
                                ‚Ä¢ <strong>x-transition</strong> : Animations
                                fluides
                            </li>
                            <li>
                                ‚Ä¢ <strong>@click/@submit</strong> : Gestion
                                d'√©v√©nements
                            </li>
                            <li>‚Ä¢ <strong>x-for</strong> : Rendu de listes</li>
                            <li>
                                ‚Ä¢ <strong>:class/:disabled</strong> : Attributs
                                dynamiques
                            </li>
                        </ul>
                    </div>
                </div>
            </main>
        </div>

        <!-- Script Alpine.js -->
        <script>
            function taskManager() {
                return {
                    // Il ne reste plus qu'√† impl√©menter l'ensemble des scripts qui a √©t√© vu en amont.
                };
            }
        </script>
    </body>
</html>
```

:::warning
Veuillez ajouter le code JavaScript qui a √©t√© expliquer √† l'emplacement attendu.
:::

## **Route pour la Vue Alpine.js**

:::note Emplacement Fichier
**`routes/web.php`**
:::

```php
<?php

// Route pour la vue Alpine.js
Route::get('/', function () {
    return view('alpine-tasks');
});
```

## Diagramme de S√©quence Alpine.js

```mermaid
---
config:
  theme: 'neutral'
---
sequenceDiagram
    participant U as Utilisateur
    participant A as Alpine.js
    participant API as API Laravel
    participant DB as Base de donn√©es

    Note over U,DB: Chargement initial
    U->>A: Visite la page
    A->>A: x-init="init()"
    A->>API: GET /api/tasks
    API->>DB: SELECT * FROM tasks
    DB-->>API: Donn√©es
    API-->>A: JSON Response
    A-->>U: Interface mise √† jour

    Note over U,DB: Interaction c√¥t√© client
    U->>A: Tape dans le formulaire
    A->>A: x-model r√©activit√©
    A-->>U: Validation temps r√©el

    U->>A: Clique "Ajouter"
    A->>A: @click="addTask()"
    A->>API: POST /api/tasks
    API->>DB: INSERT INTO tasks
    DB-->>API: Nouvelle t√¢che
    API-->>A: JSON Response
    A->>A: Mise √† jour du state
    A-->>U: DOM mis √† jour automatiquement
```

## Avantages d'Alpine.js

-   ‚úÖ **L√©ger** : _Moins de 15KB, id√©al pour les performances._
-   ‚úÖ **Simplicit√©** : _Syntaxe intuitive, courbe d'apprentissage douce._
-   ‚úÖ **R√©activit√©** : _Mises √† jour automatiques du DOM c√¥t√© client._
-   ‚úÖ **Flexibilit√©** : _Peut √™tre ajout√© progressivement √† une application existante._
-   ‚úÖ **Performance** : _Pas de Virtual DOM, manipulations directes._

## Diff√©rences avec Livewire

| Aspect         | Alpine.js                    | Livewire                   |
| -------------- | ---------------------------- | -------------------------- |
| **Logique**    | C√¥t√© client (JavaScript)     | C√¥t√© serveur (PHP)         |
| **API**        | N√©cessite une API REST       | Int√©gr√© avec Laravel       |
| **R√©activit√©** | Imm√©diate (client)           | Via requ√™tes AJAX          |
| **S√©curit√©**   | Validation c√¥t√© client + API | Validation c√¥t√© serveur    |
| **Complexit√©** | Plus de code JS              | Moins de code, plus simple |

<br />

:::tip R√©sultat imm√©diat
Interface riche et r√©active avec Alpine.js pur !
:::
