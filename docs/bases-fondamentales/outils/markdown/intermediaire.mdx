import Badge from '../../../../src/components/Badge';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Markdown : Interm√©diaire

:::note
**Temps de lecture :** 45 minutes  
**Objectif :** Ma√Ætriser les fonctionnalit√©s avanc√©es pour une utilisation professionnelle
:::

## 1. Tableaux Professionnels <Badge niveau="Interm√©diaire" />

### 1.1 Syntaxe et Formatage

Les tableaux permettent d'organiser des donn√©es de mani√®re structur√©e et lisible.

:::tip Bonnes Pratiques Tableaux

-   **Espacement coh√©rent** : Aligner visuellement les `|` dans le source
-   **En-t√™tes descriptifs** : Noms de colonnes clairs et pr√©cis
-   **Donn√©es homog√®nes** : M√™me type de contenu par colonne
-   **Taille raisonnable** : Maximum 6-8 colonnes pour la lisibilit√© mobile

:::

<Tabs>
<TabItem value="syntaxe" label="Syntaxe de Base">

```markdown
| Colonne 1 | Colonne 2 | Colonne 3 |
| --------- | --------- | --------- |
| Donn√©e 1  | Donn√©e 2  | Donn√©e 3  |
| Ligne 2   | Valeur 2  | Valeur 3  |
| Ligne 3   | Valeur 4  | Valeur 5  |
```

</TabItem>
<TabItem value="resultat" label="R√©sultat">

| Colonne 1 | Colonne 2 | Colonne 3 |
| --------- | --------- | --------- |
| Donn√©e 1  | Donn√©e 2  | Donn√©e 3  |
| Ligne 2   | Valeur 2  | Valeur 3  |
| Ligne 3   | Valeur 4  | Valeur 5  |

</TabItem>
<TabItem value="alignement" label="Alignement des Colonnes">

```markdown
| Gauche | Centr√© | Droite |   Auto |
| :----- | :----: | -----: | -----: |
| Texte  | Texte  |  Texte |  Texte |
| Align√© | Align√© | Align√© | Normal |
| Gauche | Centre | Droite | D√©faut |
```

**L√©gende des alignements :**

-   `:---` = Alignement √† gauche
-   `:---:` = Alignement centr√©
-   `---:` = Alignement √† droite
-   `---` = Alignement automatique

#### R√©sultat

| Gauche | Centr√© | Droite |   Auto |
| :----- | :----: | -----: | -----: |
| Texte  | Texte  |  Texte |  Texte |
| Align√© | Align√© | Align√© | Normal |
| Gauche | Centre | Droite | D√©faut |

</TabItem>
<TabItem value="schema" label="Sch√©ma de construction d'un tableau">

```mermaid
graph TB
    A[Tableau Markdown] --> B[Ligne d'en-t√™tes]
    A --> C[Ligne de s√©parateurs]
    A --> D[Lignes de donn√©es]

    B --> E["| Colonne 1 | Colonne 2 |"]
    C --> F["|:---------|:---------:|"]
    D --> G["| Donn√©e 1 | Donn√©e 2 |"]
    D --> H["| Donn√©e 3 | Donn√©e 4 |"]

    F --> I[Alignement d√©fini ici]

    style A fill:#e3f2fd
    style C fill:#fff3c4
    style I fill:#ffccbc
```

</TabItem>
</Tabs>

### 1.2 Tableaux Complexes et Cas d'Usage

<Tabs>
<TabItem value="technique" label="Donn√©es Techniques">

```markdown
## Comparaison des Technologies

| Technologie | Performance |  S√©curit√©  | Complexit√© |  Support   |  Score |
| ----------- | :---------: | :--------: | :--------: | :--------: | -----: |
| **Node.js** |  ‚≠ê‚≠ê‚≠ê‚≠ê   |   ‚≠ê‚≠ê‚≠ê   |   ‚≠ê‚≠ê‚≠ê   | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | 85/100 |
| **Python**  |   ‚≠ê‚≠ê‚≠ê    |  ‚≠ê‚≠ê‚≠ê‚≠ê  |    ‚≠ê‚≠ê    | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | 82/100 |
| **Java**    | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê  | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |  ‚≠ê‚≠ê‚≠ê‚≠ê  | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | 95/100 |
| **Go**      | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê  |  ‚≠ê‚≠ê‚≠ê‚≠ê  |   ‚≠ê‚≠ê‚≠ê   |   ‚≠ê‚≠ê‚≠ê   | 88/100 |
```

</TabItem>
<TabItem value="resultat" label="R√©sultat Donn√©es Techniques">

| Technologie | Performance |  S√©curit√©  | Complexit√© |  Support   |  Score |
| ----------- | :---------: | :--------: | :--------: | :--------: | -----: |
| **Node.js** |  ‚≠ê‚≠ê‚≠ê‚≠ê   |   ‚≠ê‚≠ê‚≠ê   |   ‚≠ê‚≠ê‚≠ê   | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | 85/100 |
| **Python**  |   ‚≠ê‚≠ê‚≠ê    |  ‚≠ê‚≠ê‚≠ê‚≠ê  |    ‚≠ê‚≠ê    | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | 82/100 |
| **Java**    | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê  | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |  ‚≠ê‚≠ê‚≠ê‚≠ê  | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | 95/100 |
| **Go**      | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê  |  ‚≠ê‚≠ê‚≠ê‚≠ê  |   ‚≠ê‚≠ê‚≠ê   |   ‚≠ê‚≠ê‚≠ê   | 88/100 |

</TabItem>
</Tabs>

<Tabs>
<TabItem value="devops" label="Tableau DevSecOps">

```markdown
## Pipeline CI/CD - Statut des Environnements

| Environnement | Build Status | Tests  |  S√©curit√©  |  Deploy   | Monitoring |
| ------------- | :----------: | :----: | :--------: | :-------: | :--------: |
| **DEV**       |  ‚úÖ Passing  | ‚úÖ 98% | ‚ö†Ô∏è Warning |  ‚úÖ Auto  | üü¢ Healthy |
| **STAGING**   |  ‚úÖ Passing  | ‚úÖ 95% | ‚úÖ Secure  |  ‚úÖ Auto  | üü¢ Healthy |
| **PROD**      |  ‚úÖ Passing  | ‚úÖ 99% | ‚úÖ Secure  | üîí Manual | üü¢ Healthy |
| **DR**        |  ‚è∏Ô∏è Stopped  | ‚ûñ N/A | ‚úÖ Secure  | üîí Manual | üü° Standby |
```

</TabItem>
<TabItem value="resultat" label="R√©sultat Tableau DevSecOps">

| Environnement | Build Status | Tests  |  S√©curit√©  |  Deploy   | Monitoring |
| ------------- | :----------: | :----: | :--------: | :-------: | :--------: |
| **DEV**       |  ‚úÖ Passing  | ‚úÖ 98% | ‚ö†Ô∏è Warning |  ‚úÖ Auto  | üü¢ Healthy |
| **STAGING**   |  ‚úÖ Passing  | ‚úÖ 95% | ‚úÖ Secure  |  ‚úÖ Auto  | üü¢ Healthy |
| **PROD**      |  ‚úÖ Passing  | ‚úÖ 99% | ‚úÖ Secure  | üîí Manual | üü¢ Healthy |
| **DR**        |  ‚è∏Ô∏è Stopped  | ‚ûñ N/A | ‚úÖ Secure  | üîí Manual | üü° Standby |

</TabItem>
</Tabs>

<Tabs>
<TabItem value="audit" label="Audit de S√©curit√©">

```markdown
## Vuln√©rabilit√©s par Criticit√©

| Composant        | Critique | √âlev√© | Moyen | Faible | Score CVSS | Action                   |
| ---------------- | :------: | :---: | :---: | :----: | :--------: | ------------------------ |
| **API Core**     |    0     |   1   |   3   |   5    |    6.2     | ‚ö†Ô∏è Correction requise    |
| **Auth Service** |    0     |   0   |   2   |   1    |    4.1     | ‚úÖ Acceptable            |
| **Database**     |    1     |   0   |   1   |   2    |    8.9     | üö® **URGENT**            |
| **Frontend**     |    0     |   2   |   4   |   8    |    5.8     | ‚ö†Ô∏è Planifier correction  |
| **Dependencies** |    0     |   3   |  12   |   25   |    5.4     | üìÖ Mise √† jour r√©guli√®re |
```

</TabItem>
<TabItem value="resultat" label="R√©sultat Audit">

| Composant        | Critique | √âlev√© | Moyen | Faible | Score CVSS | Action                   |
| ---------------- | :------: | :---: | :---: | :----: | :--------: | ------------------------ |
| **API Core**     |    0     |   1   |   3   |   5    |    6.2     | ‚ö†Ô∏è Correction requise    |
| **Auth Service** |    0     |   0   |   2   |   1    |    4.1     | ‚úÖ Acceptable            |
| **Database**     |    1     |   0   |   1   |   2    |    8.9     | üö® **URGENT**            |
| **Frontend**     |    0     |   2   |   4   |   8    |    5.8     | ‚ö†Ô∏è Planifier correction  |
| **Dependencies** |    0     |   3   |  12   |   25   |    5.4     | üìÖ Mise √† jour r√©guli√®re |

</TabItem>
</Tabs>

### 1.3 Limitations et Alternatives

:::danger Comprendre la Limitations des Tableaux Markdown
Les tableaux Markdown ont des contraintes importantes :

-   **Pas de fusion de cellules** native
-   **Pas de formatage avanc√©** (couleurs, bordures personnalis√©es)
-   **Difficult√© avec contenu long** dans les cellules
-   **Responsive limit√©** sur mobile
    :::

<Tabs>
<TabItem value="html" label="Solution HTML pour Cas Complexes">

```html
<!-- Tableau avec fusion de cellules -->
<table>
    <thead>
        <tr>
            <th rowspan="2">Service</th>
            <th colspan="2">Performance</th>
            <th rowspan="2">Status</th>
        </tr>
        <tr>
            <th>Latence</th>
            <th>Throughput</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>API Gateway</strong></td>
            <td>15ms</td>
            <td>10k req/s</td>
            <td>üü¢ Healthy</td>
        </tr>
        <tr>
            <td><strong>Auth Service</strong></td>
            <td>8ms</td>
            <td>5k req/s</td>
            <td>üü¢ Healthy</td>
        </tr>
    </tbody>
</table>
```

</TabItem>
<TabItem value="html-result" label="R√©sultat Solution HTML pour Cas Complexes">

<!-- Tableau avec fusion de cellules -->

<table>
    <thead>
        <tr>
            <th rowspan="2">Service</th>
            <th colspan="2">Performance</th>
            <th rowspan="2">Status</th>
        </tr>
        <tr>
            <th>Latence</th>
            <th>Throughput</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                <strong>API Gateway</strong>
            </td>
            <td>15ms</td>
            <td>10k req/s</td>
            <td>üü¢ Healthy</td>
        </tr>
        <tr>
            <td>
                <strong>Auth Service</strong>
            </td>
            <td>8ms</td>
            <td>5k req/s</td>
            <td>üü¢ Healthy</td>
        </tr>
    </tbody>
</table>

</TabItem>
</Tabs>

## 2. Blocs de Code Avanc√©s <Badge niveau="Interm√©diaire" />

### 2.1 Code Inline Optimis√©

L'utilisation appropri√©e du code inline am√©liore la lisibilit√© technique.

<Tabs>
<TabItem value="variables" label="Variables et Configuration">

```markdown
## Configuration Serveur

La variable d'environnement `NODE_ENV` doit √™tre d√©finie sur `production`.
Le fichier de configuration `config.json` contient les param√®tres `database.host` et `database.port`.

Pour modifier le timeout, utilisez le param√®tre `--timeout=30s` lors du d√©marrage.
```

</TabItem>
<TabItem value="resultat-variables" label="R√©sultat Variables et Configuration">

:::warning
Ici **volontairement** j'ai d√©fini un titre (h4) au lieu du (h2) pour √©viter de casser la navigation sur votre droite.
:::

#### Confiuration Serveur

La variable d'environnement `NODE_ENV` doit √™tre d√©finie sur `production`.
Le fichier de configuration `config.json` contient les param√®tres `database.host` et `database.port`.

Pour modifier le timeout, utilisez le param√®tre `--timeout=30s` lors du d√©marrage.

</TabItem>
</Tabs>

<Tabs>
<TabItem value="commandes" label="Commandes et API">

```markdown
## Commandes Docker

Lancer le conteneur avec `docker run -d --name api-server image:latest`.
V√©rifier les logs avec `docker logs api-server`.
Acc√©der au conteneur via `docker exec -it api-server /bin/bash`.

## Endpoints API

-   `GET /api/users` - Liste tous les utilisateurs
-   `POST /api/users` - Cr√©e un nouvel utilisateur
-   `PUT /api/users/{id}` - Met √† jour l'utilisateur `{id}`
-   `DELETE /api/users/{id}` - Supprime l'utilisateur `{id}`
```

</TabItem>
<TabItem value="resultat-commandes" label="R√©sultat Commandes et API">

:::warning
Ici **volontairement** j'ai d√©fini un titre (h4) au lieu du (h2) pour √©viter de casser la navigation sur votre droite.
:::

#### Commandes Docker

Lancer le conteneur avec `docker run -d --name api-server image:latest`.
V√©rifier les logs avec `docker logs api-server`.
Acc√©der au conteneur via `docker exec -it api-server /bin/bash`.

#### Endpoints API

-   `GET /api/users` - Liste tous les utilisateurs
-   `POST /api/users` - Cr√©e un nouvel utilisateur
-   `PUT /api/users/{id}` - Met √† jour l'utilisateur `{id}`
-   `DELETE /api/users/{id}` - Supprime l'utilisateur `{id}`

</TabItem>
</Tabs>

### 2.2 Blocs de Code avec Coloration Syntaxique

La coloration syntaxique am√©liore la lisibilit√© et la compr√©hension du code.

:::warning Attention
Si vous ne comprenez pas les morceaux de codes pr√©sent√©s ici, **ce n'est vraiment pas grave**. L'essentiel ici est de comprendre comment cr√©er un bloc de code et le pr√©senter proprement.

:::

<Tabs>
<TabItem value="javascript" label="JavaScript / Node.js">

#### Syntaxe

````markdown
```js
# Ceci est un commentaires
const express = require('express');
```
````

#### Exemple de code avec coloration syntaxique

```javascript
// Configuration s√©curis√©e de l'API Express
const express = require('express');
const helmet = require('helmet'); // S√©curit√© HTTP headers
const rateLimit = require('express-rate-limit'); // Rate limiting
const jwt = require('jsonwebtoken');

const app = express();

// Middleware de s√©curit√©
app.use(helmet()); // Protection des headers HTTP
app.use(express.json({ limit: '10mb' })); // Limite taille payload

// Rate limiting global
const limiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 minutes
    max: 100, // Limite chaque IP √† 100 requ√™tes par fen√™tre
    message: 'Too many requests from this IP',
    standardHeaders: true, // Return rate limit info in the `RateLimit-*` headers
    legacyHeaders: false, // Disable the `X-RateLimit-*` headers
});

app.use('/api/', limiter);

// Middleware d'authentification JWT
const authenticateToken = (req, res, next) => {
    const authHeader = req.headers['authorization'];
    const token = authHeader && authHeader.split(' ')[1]; // Bearer TOKEN

    if (!token) {
        return res.sendStatus(401); // Unauthorized
    }

    jwt.verify(token, process.env.ACCESS_TOKEN_SECRET, (err, user) => {
        if (err) return res.sendStatus(403); // Forbidden
        req.user = user;
        next(); // Continue vers la route suivante
    });
};

// Route prot√©g√©e avec validation
app.get('/api/users', authenticateToken, async (req, res) => {
    try {
        // Logique m√©tier avec gestion d'erreur
        const users = await getUsersFromDatabase();
        res.json({ success: true, data: users });
    } catch (error) {
        console.error('Erreur r√©cup√©ration utilisateurs:', error);
        res.status(500).json({
            success: false,
            error: 'Internal server error',
        });
    }
});

module.exports = app;
```

</TabItem>
<TabItem value="python" label="Python / Django">

#### Syntaxe

````markdown
```python
# models.py - Mod√®les Django avec s√©curit√© renforc√©e
from django.db import models

# ... reste du code
```
````

#### Exemple de code avec coloration syntaxique

```python
# models.py - Mod√®les Django avec s√©curit√© renforc√©e
from django.db import models
from django.contrib.auth.models import AbstractUser
from django.core.validators import RegexValidator
from django.utils import timezone
import uuid

class CustomUser(AbstractUser):
    """Mod√®le utilisateur personnalis√© avec champs s√©curis√©s"""

    # Identifiant unique UUID pour √©viter l'√©num√©ration
    uuid = models.UUIDField(
        default=uuid.uuid4,
        editable=False,
        unique=True,
        help_text="Identifiant unique non-s√©quentiel"
    )

    # Validation du num√©ro de t√©l√©phone
    phone_regex = RegexValidator(
        regex=r'^\+?1?\d{9,15}$',
        message="Format: '+999999999'. Maximum 15 chiffres."
    )
    phone_number = models.CharField(
        validators=[phone_regex],
        max_length=17,
        blank=True,
        help_text="Num√©ro de t√©l√©phone au format international"
    )

    # Champs d'audit automatiques
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    last_login_ip = models.GenericIPAddressField(null=True, blank=True)

    # Flag de s√©curit√©
    is_verified = models.BooleanField(
        default=False,
        help_text="Compte v√©rifi√© par email/SMS"
    )
    failed_login_attempts = models.PositiveIntegerField(
        default=0,
        help_text="Nombre de tentatives de connexion √©chou√©es"
    )

    class Meta:
        db_table = 'auth_custom_user'
        indexes = [
            models.Index(fields=['email']),
            models.Index(fields=['uuid']),
            models.Index(fields=['created_at']),
        ]

    def __str__(self):
        return f"{self.username} ({self.uuid})"

    def reset_failed_attempts(self):
        """Remet √† z√©ro le compteur de tentatives √©chou√©es"""
        self.failed_login_attempts = 0
        self.save(update_fields=['failed_login_attempts'])
```

</TabItem>
<TabItem value="bash" label="Bash / DevOps">

#### Syntaxe

````markdown
```bash
#!/bin/bash
# deploy.sh - Script de d√©ploiement s√©curis√© avec v√©rifications

set -euo pipefail  # Arr√™t strict en cas d'erreur
```
````

#### Exemple de code avec coloration syntaxique

```bash
#!/bin/bash
# deploy.sh - Script de d√©ploiement s√©curis√© avec v√©rifications

set -euo pipefail  # Arr√™t strict en cas d'erreur

# Couleurs pour l'affichage
readonly RED='\033[0;31m'
readonly GREEN='\033[0;32m'
readonly YELLOW='\033[1;33m'
readonly NC='\033[0m' # No Color

# Variables de configuration
readonly APP_NAME="api-secure"
readonly DEPLOY_ENV="${1:-staging}"  # staging par d√©faut
readonly BACKUP_DIR="/backup/$(date +%Y%m%d_%H%M%S)"
readonly LOG_FILE="/var/log/deploy-$(date +%Y%m%d).log"

# Fonction de logging avec timestamp
log() {
    local level=$1
    shift
    echo -e "[$(date '+%Y-%m-%d %H:%M:%S')] [$level] $*" | tee -a "$LOG_FILE"
}

# Fonction d'erreur avec nettoyage
error_exit() {
    log "ERROR" "${RED}$1${NC}"
    cleanup
    exit 1
}

# Fonction de nettoyage en cas d'√©chec
cleanup() {
    log "INFO" "Nettoyage des fichiers temporaires..."
    rm -rf /tmp/deploy-*
}

# V√©rification des pr√©requis
check_prerequisites() {
    log "INFO" "V√©rification des pr√©requis..."

    # V√©rifier si l'utilisateur a les droits n√©cessaires
    if [[ $EUID -ne 0 ]] && [[ "$DEPLOY_ENV" == "production" ]]; then
        error_exit "Le d√©ploiement en production n√©cessite les droits root"
    fi

    # V√©rifier la disponibilit√© des outils
    local tools=("docker" "git" "curl" "jq")
    for tool in "${tools[@]}"; do
        if ! command -v "$tool" &> /dev/null; then
            error_exit "Outil requis manquant: $tool"
        fi
    done

    # V√©rifier l'espace disque (minimum 1GB)
    local available_space=$(df / | awk 'NR==2 {print $4}')
    if [[ $available_space -lt 1048576 ]]; then
        error_exit "Espace disque insuffisant (< 1GB disponible)"
    fi

    log "INFO" "${GREEN}Pr√©requis valid√©s${NC}"
}

# Fonction de sauvegarde avant d√©ploiement
backup_current_version() {
    log "INFO" "Sauvegarde de la version actuelle..."

    if [[ -d "/var/www/$APP_NAME" ]]; then
        mkdir -p "$BACKUP_DIR"
        cp -r "/var/www/$APP_NAME" "$BACKUP_DIR/"

        # Sauvegarde de la base de donn√©es
        docker exec db-container pg_dump -U postgres api_db > "$BACKUP_DIR/database.sql"

        log "INFO" "${GREEN}Sauvegarde cr√©√©e: $BACKUP_DIR${NC}"
    else
        log "WARN" "${YELLOW}Aucune version existante √† sauvegarder${NC}"
    fi
}

# D√©ploiement principal
deploy_application() {
    log "INFO" "D√©but du d√©ploiement de $APP_NAME en environnement $DEPLOY_ENV"

    # R√©cup√©ration du code source
    cd /tmp
    git clone --depth 1 https://github.com/company/$APP_NAME.git deploy-$APP_NAME
    cd deploy-$APP_NAME

    # V√©rification de l'int√©grit√© (checksums, signatures GPG)
    if [[ -f "checksums.sha256" ]]; then
        sha256sum -c checksums.sha256 || error_exit "V√©rification d'int√©grit√© √©chou√©e"
    fi

    # Construction de l'image Docker
    docker build -t "$APP_NAME:latest" . || error_exit "Construction Docker √©chou√©e"

    # Tests de s√©curit√© (exemple avec Trivy)
    if command -v trivy &> /dev/null; then
        log "INFO" "Scan de s√©curit√© de l'image..."
        trivy image --severity HIGH,CRITICAL "$APP_NAME:latest" || error_exit "Vuln√©rabilit√©s critiques d√©tect√©es"
    fi

    # Arr√™t gracieux de l'ancienne version
    if docker ps | grep -q "$APP_NAME"; then
        log "INFO" "Arr√™t gracieux de l'ancienne version..."
        docker stop "$APP_NAME" || true
        docker rm "$APP_NAME" || true
    fi

    # D√©marrage de la nouvelle version
    docker run -d \
        --name "$APP_NAME" \
        --restart unless-stopped \
        -p 3000:3000 \
        -v /var/log/$APP_NAME:/app/logs \
        -e NODE_ENV="$DEPLOY_ENV" \
        "$APP_NAME:latest" || error_exit "D√©marrage de l'application √©chou√©"

    # V√©rification de sant√©
    log "INFO" "V√©rification de sant√© de l'application..."
    local max_attempts=30
    local attempt=1

    while [[ $attempt -le $max_attempts ]]; do
        if curl -f http://localhost:3000/health &> /dev/null; then
            log "INFO" "${GREEN}Application d√©ploy√©e avec succ√®s !${NC}"
            return 0
        fi

        log "INFO" "Tentative $attempt/$max_attempts - En attente..."
        sleep 10
        ((attempt++))
    done

    error_exit "L'application ne r√©pond pas apr√®s le d√©ploiement"
}

# Point d'entr√©e principal
main() {
    log "INFO" "=== D√©but du d√©ploiement ==="

    check_prerequisites
    backup_current_version
    deploy_application

    log "INFO" "${GREEN}=== D√©ploiement termin√© avec succ√®s ===${NC}"
}

# Gestion des signaux pour nettoyage
trap cleanup INT TERM

# Ex√©cution
main "$@"
```

</TabItem>
</Tabs>

### 2.3 Blocs Diff - Visualisation des Modifications <Badge niveau="Avanc√©" />

Les blocs diff permettent de montrer clairement les modifications de code avec des couleurs.

<Tabs>
<TabItem value="syntaxe" label="Syntaxe des Blocs Diff">

#### Syntaxe

````markdown
```diff
// Am√©lioration de la s√©curit√© d'authentification
function authenticateUser(username, password) {
-   // Ancienne m√©thode non s√©curis√©e
-   if (password === user.password) {
-       return { success: true, user: user };
-   }
+   // Nouvelle m√©thode avec hachage bcrypt
+   const isValid = await bcrypt.compare(password, user.hashedPassword);
+   if (isValid) {
+       return {
+           success: true,
+           user: { id: user.id, username: user.username } // Pas de donn√©es sensibles
+       };
+   }

    return { success: false, error: 'Invalid credentials' };
}

// Configuration de session s√©curis√©e
const sessionConfig = {
-   secret: 'simple-secret',
-   secure: false,
+   secret: process.env.SESSION_SECRET, // Secret depuis variable d'environnement
+   secure: process.env.NODE_ENV === 'production', // HTTPS en production
+   httpOnly: true, // Protection XSS
+   sameSite: 'strict' // Protection CSRF
};
```
````

#### Exemple de code avec coloration syntaxique

:::danger ATTENTION
Sur docusaurus, ce bout de code n'est pas intr√©pr√©t√© ainsi, il faudrait l'utiliser sur GitHub pour le voir en action.

:::

```diff
// Am√©lioration de la s√©curit√© d'authentification
function authenticateUser(username, password) {
-   // Ancienne m√©thode non s√©curis√©e
-   if (password === user.password) {
-       return { success: true, user: user };
-   }
+   // Nouvelle m√©thode avec hachage bcrypt
+   const isValid = await bcrypt.compare(password, user.hashedPassword);
+   if (isValid) {
+       return {
+           success: true,
+           user: { id: user.id, username: user.username } // Pas de donn√©es sensibles
+       };
+   }

    return { success: false, error: 'Invalid credentials' };
}

// Configuration de session s√©curis√©e
const sessionConfig = {
-   secret: 'simple-secret',
-   secure: false,
+   secret: process.env.SESSION_SECRET, // Secret depuis variable d'environnement
+   secure: process.env.NODE_ENV === 'production', // HTTPS en production
+   httpOnly: true, // Protection XSS
+   sameSite: 'strict' // Protection CSRF
};
```

**Convention des couleurs :**

-   Lignes avec `+` : **üü¢ Vert** (ajouts/am√©liorations)
-   Lignes avec `-` : **üî¥ Rouge** (suppressions/obsol√®te)
-   Lignes normales : **‚ö™ Blanc** (contexte inchang√©)

</TabItem>
<TabItem value="config" label="Modifications de Configuration">

````markdown
```diff
# docker-compose.yml - S√©curisation des services
version: '3.8'

services:
  api:
    image: node:18-alpine
-   ports:
-     - "3000:3000"  # Port expos√© publiquement
+   expose:
+     - "3000"  # Port interne uniquement
    environment:
-     - NODE_ENV=development
+     - NODE_ENV=production
+     - RATE_LIMIT=100
    volumes:
-     - .:/app  # Mount complet du code source
+     - ./dist:/app  # Uniquement les fichiers build√©s
+   user: "node"  # Utilisateur non-root
+   read_only: true  # Syst√®me de fichiers en lecture seule
+   tmpfs:
+     - /tmp

  database:
    image: postgres:15-alpine
    environment:
-     POSTGRES_PASSWORD: password123
+     POSTGRES_PASSWORD_FILE: /run/secrets/db_password
+   secrets:
+     - db_password
    volumes:
      - db_data:/var/lib/postgresql/data
+   networks:
+     - backend  # R√©seau interne isol√©

+ proxy:
+   image: nginx:alpine
+   ports:
+     - "80:80"
+     - "443:443"
+   volumes:
+     - ./nginx.conf:/etc/nginx/nginx.conf:ro
+     - ./ssl:/etc/ssl/certs:ro
+   depends_on:
+     - api

+networks:
+  backend:
+    driver: bridge
+    internal: true

+secrets:
+  db_password:
+    file: ./secrets/db_password.txt
```
````

</TabItem>
<TabItem value="pipeline" label="Pipeline CI/CD">

````markdown
```diff
# .github/workflows/deploy.yml - Ajout des contr√¥les de s√©curit√©
name: Deploy Application

on:
  push:
    branches: [ main ]
+   paths-ignore:
+     - '**.md'
+     - 'docs/**'

jobs:
  security-scan:
+   runs-on: ubuntu-latest
+   steps:
+     - uses: actions/checkout@v3
+
+     # Scan des secrets dans le code
+     - name: Secret Scan
+       uses: trufflesecurity/trufflehog@main
+       with:
+         path: ./
+
+     # Analyse des d√©pendances
+     - name: Dependency Scan
+       run: |
+         npm audit --audit-level high
+         npm audit fix

  test:
    runs-on: ubuntu-latest
+   needs: security-scan
    steps:
      - uses: actions/checkout@v3
+       with:
+         fetch-depth: 0  # Historique complet pour SonarQube

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
+         cache: 'npm'

      - name: Install dependencies
        run: npm ci
+
+     # Tests de s√©curit√©
+     - name: Security Tests
+       run: |
+         npm run test:security
+         npm run test:integration

  deploy:
    runs-on: ubuntu-latest
    needs: test
+   if: github.ref == 'refs/heads/main'
    environment: production
    steps:
-     - name: Deploy to server
-       run: scp -r ./ user@server:/app/
+     - name: Deploy with Docker
+       run: |
+         docker build -t app:${{ github.sha }} .
+         docker tag app:${{ github.sha }} registry.company.com/app:latest
+         docker push registry.company.com/app:latest
+
+     # V√©rification post-d√©ploiement
+     - name: Health Check
+       run: |
+         sleep 30
+         curl -f https://api.company.com/health || exit 1
```
````

</TabItem>
</Tabs>

## 3. Extensions GitHub Flavored Markdown <Badge niveau="Avanc√©" />

### 3.1 Mentions et R√©f√©rences Collaboratives

GitHub Flavored Markdown (GFM) ajoute des fonctionnalit√©s sp√©cifiques √† la collaboration d'√©quipe.

:::danger Fonctionnalit√© disponible uniquement avec GitHub payant

L'utilisation des mentions d'**√©quipes** comme `@security-team`, `@devops-team`, ou `@qa-team` n√©cessite une **organisation GitHub** avec une **formule payante** (GitHub Team ou Enterprise).

Sans cela :

-   Les √©quipes ne peuvent **pas √™tre mentionn√©es** dans les issues ou pull requests.
-   Aucun membre ne recevra de notification via `@nom-de-l-√©quipe`.
-   L'autocompl√©tion `@` n‚Äôaffichera que des **utilisateurs individuels**.

**V√©rifie la disponibilit√© des √©quipes** dans ton d√©p√¥t en tapant `@` dans une issue ou une PR : si l‚Äô√©quipe n'appara√Æt pas, elle n‚Äôest pas reconnue.

:::

<Tabs>
<TabItem value="mentions" label="Mentions Utilisateurs et √âquipes">

```markdown
## Review de Code

**D√©veloppeur principal :** @john-doe  
**√âquipe responsable :** @frontend-team  
**Reviewer s√©curit√© :** @security-team

### Assignations

-   **Frontend :** @alice-dev @bob-dev
-   **Backend :** @charlie-api @david-db
-   **DevOps :** @eve-ops @frank-infra

### Notifications Automatiques

Les mentions `@username` g√©n√®rent des notifications automatiques.
Les √©quipes `@team-name` notifient tous les membres de l'√©quipe.
```

#### Utilisation Professionnelle

**Dans les Pull Requests :**

-   `@reviewer-lead` pour demander une review prioritaire
-   `@security-team` pour les modifications sensibles
-   `@devops-team` pour les changements d'infrastructure

**Dans les Issues :**

-   `@product-owner` pour validation fonctionnelle
-   `@qa-team` pour d√©finir les crit√®res de test

</TabItem>
<TabItem value="references" label="R√©f√©rences Issues et PR">

```markdown
## R√©f√©rences Automatiques

### Issues

-   Correction du bug #123
-   Am√©lioration demand√©e dans #456
-   Feature request #789 impl√©ment√©e

### Pull Requests

-   Review de la PR #42
-   Merger apr√®s validation de PR #56
-   Conflicts r√©solus dans PR #78

### Cross-Repository

-   Issue li√©e: user/other-repo#25
-   Documentation: company/docs#12
-   Template utilis√©: company/templates#5

### Mots-cl√©s de Fermeture

-   Closes #123
-   Fixes #456
-   Resolves #789
```

#### Mots-cl√©s Automatiques

| Mot-cl√©         | Action          | Exemple                            |
| --------------- | --------------- | ---------------------------------- |
| `closes #123`   | Ferme l'issue   | `Closes #123` dans commit/PR       |
| `fixes #123`    | Corrige l'issue | `Fixes #123: Bug authentification` |
| `resolves #123` | R√©sout l'issue  | `Resolves #123 with new algorithm` |

</TabItem>
</Tabs>

### 3.2 √âmojis et Communication Moderne

<Tabs>
<TabItem value="emoji-syntaxe" label="Syntaxe des √âmojis">

```markdown
## Status du Projet

### D√©veloppement

-   :white_check_mark: Authentification termin√©e
-   :construction: API en cours de d√©veloppement
-   :warning: Base de donn√©es n√©cessite optimisation
-   :x: Tests d'int√©gration √©chou√©s

### Environnements

-   **Production :** :green_heart: Stable
-   **Staging :** :yellow_heart: Tests en cours
-   **Development :** :heart: Active

### √âquipe

-   :rocket: Nouvelle fonctionnalit√© d√©ploy√©e
-   :bug: Bug critique identifi√©
-   :ambulance: Hotfix n√©cessaire
-   :sparkles: Am√©lioration UI/UX
```

#### R√©sultat - D√©veloppement

-   ‚úÖ Authentification termin√©e
-   üöß API en cours de d√©veloppement
-   ‚ö†Ô∏è Base de donn√©es n√©cessite optimisation
-   ‚ùå Tests d'int√©gration √©chou√©s

#### R√©sultat - Environnements

-   **Production :** üíö Stable
-   **Staging :** üíõ Tests en cours
-   **Development :** ‚ù§Ô∏è Active

#### R√©sultat - √âquipe

-   :rocket: Nouvelle fonctionnalit√© d√©ploy√©e
-   :bug: Bug critique identifi√©
-   :ambulance: Hotfix n√©cessaire
-   :sparkles: Am√©lioration UI/UX

</TabItem>
<TabItem value="emoji-categories" label="Cat√©gories d'√âmojis Professionnels">

```markdown
## Guide des √âmojis DevSecOps

### üîß D√©veloppement

-   :wrench: Configuration/Setup
-   :gear: Param√®tres syst√®me
-   :hammer: Outil de d√©veloppement
-   :nut_and_bolt: Composant technique

### üöÄ D√©ploiement

-   :rocket: Nouvelle release
-   :package: Build/Package
-   :ship: Mise en production
-   :anchor: Version stable

### üîí S√©curit√©

-   :lock: Authentification
-   :key: Gestion des cl√©s
-   :shield: Protection/Firewall
-   :closed_lock_with_key: Chiffrement

### üìä Monitoring

-   :chart_with_upwards_trend: Performance
-   :bar_chart: M√©triques
-   :eyes: Surveillance
-   :mag: Investigation

### ‚ö†Ô∏è Alertes

-   :warning: Attention requise
-   :rotating_light: Incident critique
-   :fire: Urgence maximale
-   :sos: Aide n√©cessaire
```

#### Usage Recommand√©

**Dans les commits :**

```bash
git commit -m ":lock: S√©curisation des endpoints API"
git commit -m ":bug: Correction du leak m√©moire"
git commit -m ":sparkles: Ajout authentification 2FA"
```

**Dans la documentation :**

-   üìö Guide utilisateur
-   üîß Documentation technique
-   üöÄ Guide de d√©ploiement
-   üîí Proc√©dures de s√©curit√©

</TabItem>
</Tabs>

### 3.3 Fonctionnalit√©s Collaboratives Avanc√©es

<Tabs>
<TabItem value="suggestions" label="Suggestions de Code">

````markdown
## Review Suggestions

Pour optimiser cette fonction, je sugg√®re :

```suggestion
function validateInput(data) {
  // Validation plus stricte avec Joi
  const schema = Joi.object({
    email: Joi.string().email().required(),
    password: Joi.string().min(8).pattern(new RegExp('^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])')).required()
  });

  return schema.validate(data);
}
```
````

### Commentaires de Review

> **Note:** Cette suggestion am√©liore la s√©curit√© en appliquant une validation stricte des mots de passe.
>
> **Impact:** R√©duction des risques de comptes compromis de 85%.

````

</TabItem>
<TabItem value="templates" label="Templates de PR/Issues">

```markdown
## Template Pull Request

### üìã Description
Br√®ve description des modifications apport√©es.

### üîÑ Type de changement
- [ ] Bug fix (non-breaking change qui corrige un probl√®me)
- [ ] New feature (non-breaking change qui ajoute une fonctionnalit√©)
- [ ] Breaking change (fix ou feature qui casserait la compatibilit√©)
- [ ] Documentation update

### üß™ Tests
- [ ] Tests unitaires ajout√©s/modifi√©s
- [ ] Tests d'int√©gration valid√©s
- [ ] Tests de s√©curit√© pass√©s
- [ ] Tests manuels effectu√©s

### üîí S√©curit√©
- [ ] Pas de donn√©es sensibles dans le code
- [ ] Validation d'entr√©e impl√©ment√©e
- [ ] Audit des d√©pendances effectu√©
- [ ] Review s√©curit√© demand√©e (@security-team)

### üìù Checklist
- [ ] Code auto-document√© ou comment√©
- [ ] Documentation mise √† jour
- [ ] CHANGELOG.md mis √† jour
- [ ] Version bumped si n√©cessaire

### üîó Issues li√©es
Closes #123
Related to #456
````

</TabItem>
</Tabs>

## 4. Organisation et Workflow <Badge niveau="Avanc√©" />

### 4.1 Conventions de Nommage Professionnelles

<Tabs>
<TabItem value="conventions" label="Standards par Contexte">

| √âl√©ment              | Convention        | Exemple                                     | Justification              |
| -------------------- | ----------------- | ------------------------------------------- | -------------------------- |
| **Fichiers MD**      | kebab-case        | `api-documentation.md`                      | URL friendly, lisible      |
| **Dossiers**         | kebab-case        | `user-guides/`                              | Coh√©rence syst√®me          |
| **Images**           | descriptive-kebab | `architecture-microservices-2024.png`       | SEO, maintenance           |
| **Ancres**           | lowercase-dash    | `#configuration-avanc√©e`                    | URLs propres               |
| **Constantes**       | UPPER_SNAKE_CASE  | `API_KEY`, `DB_HOST`                        | Variables d'environnement  |
| **Variables Python** | snake_case        | `user_name`, `config_file`                  | Convention Python/SQL      |
| **Variables JS**     | camelCase         | `userName`, `configFile`                    | Convention JavaScript      |
| **Classes**          | PascalCase        | `UserService`, `ApiController`              | Convention POO universelle |
| **Branches Git**     | feature/type      | `feature/auth-2fa`, `hotfix/security-patch` | Workflow GitFlow           |

</TabItem>
<TabItem value="exemples" label="Exemples Concrets">

```markdown
## Structure de Projet Documentation
```

üìÅ project-docs/
‚îú‚îÄ‚îÄ üìÑ README.md # Point d'entr√©e principal
‚îú‚îÄ‚îÄ üìÑ CONTRIBUTING.md # Guide contributeur
‚îú‚îÄ‚îÄ üìÑ SECURITY.md # Politique de s√©curit√©
‚îú‚îÄ‚îÄ üìÑ CHANGELOG.md # Historique des versions
‚îÇ
‚îú‚îÄ‚îÄ üìÅ docs/
‚îÇ ‚îú‚îÄ‚îÄ üìÅ api-reference/ # Documentation API
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÑ authentication.md
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÑ endpoints-users.md
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ üìÑ rate-limiting.md
‚îÇ ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ üìÅ user-guides/ # Guides utilisateur
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÑ getting-started.md
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÑ advanced-configuration.md
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ üìÑ troubleshooting.md
‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ üìÅ deployment/ # Documentation d√©ploiement
‚îÇ ‚îú‚îÄ‚îÄ üìÑ docker-setup.md
‚îÇ ‚îú‚îÄ‚îÄ üìÑ kubernetes-config.md
‚îÇ ‚îî‚îÄ‚îÄ üìÑ monitoring-setup.md
‚îÇ
‚îî‚îÄ‚îÄ üìÅ assets/
‚îú‚îÄ‚îÄ üìÅ images/
‚îÇ ‚îú‚îÄ‚îÄ üñºÔ∏è architecture-overview-2024.png
‚îÇ ‚îú‚îÄ‚îÄ üñºÔ∏è user-flow-authentication.svg
‚îÇ ‚îî‚îÄ‚îÄ üñºÔ∏è dashboard-monitoring-example.jpg
‚îî‚îÄ‚îÄ üìÅ diagrams/
‚îú‚îÄ‚îÄ üìÑ system-architecture.mermaid
‚îî‚îÄ‚îÄ üìÑ database-schema.drawio

````

**Avantages de cette structure :**
- ‚úÖ Navigation intuitive par domaine
- ‚úÖ Nommage coh√©rent et pr√©dictible
- ‚úÖ Scalabilit√© pour √©quipes multiples
- ‚úÖ Compatible avec g√©n√©rateurs statiques

</TabItem>
</Tabs>

### 4.2 Int√©gration Git et Versioning

<Tabs>
<TabItem value="workflow" label="Workflow de Documentation">

```markdown
## Processus de Mise √† Jour Documentation

### 1. Pr√©paration
```bash
# Cr√©er une branche pour la documentation
git checkout -b docs/update-api-reference

# V√©rifier les fichiers modifi√©s
git status
````

### 2. √âdition

-   Modifier les fichiers Markdown concern√©s
-   Ajouter/mettre √† jour les images si n√©cessaire
-   V√©rifier les liens internes/externes

### 3. Validation

```bash
# Validation des liens
markdown-link-check docs/**/*.md

# V√©rification syntaxe
markdownlint docs/

# Tests de g√©n√©ration (si applicable)
npm run docs:build
```

### 4. Commit et Review

```bash
# Commit avec message descriptif
git add docs/
git commit -m "docs: update API authentication section

- Add 2FA configuration examples
- Update rate limiting documentation
- Fix broken links to external resources

Closes #234"

# Push et cr√©ation PR
git push origin docs/update-api-reference
```

### 5. Review Process

-   [ ] **Review technique** par l'√©quipe
-   [ ] **Review factuelle** par les experts m√©tier
-   [ ] **Tests de g√©n√©ration** sur preview
-   [ ] **Validation accessibilit√©** (contrastes, alt text)

````

</TabItem>
<TabItem value="hooks" label="Git Hooks pour Documentation">

```bash
#!/bin/bash
# .git/hooks/pre-commit - Validation automatique
# Valide la documentation avant chaque commit

set -e

echo "üîç Validation de la documentation..."

# V√©rification des liens cass√©s
if command -v markdown-link-check >/dev/null 2>&1; then
    echo "üìé V√©rification des liens..."
    find docs/ -name "*.md" -exec markdown-link-check {} \;
fi

# Validation syntaxe Markdown
if command -v markdownlint >/dev/null 2>&1; then
    echo "üìù Validation syntaxe Markdown..."
    markdownlint docs/**/*.md
fi

# V√©rification des images manquantes
echo "üñºÔ∏è V√©rification des images..."
missing_images=0
for md_file in $(find docs/ -name "*.md"); do
    # Extraction des r√©f√©rences d'images
    grep -oE '!\[.*\]\([^)]+\)' "$md_file" | while read -r img_ref; do
        img_path=$(echo "$img_ref" | sed -n 's/.*(\([^)]*\)).*/\1/p')

        # V√©rifier si le fichier existe (chemins relatifs)
        if [[ ! "$img_path" =~ ^https?:// ]] && [[ ! -f "docs/$img_path" ]] && [[ ! -f "$img_path" ]]; then
            echo "‚ùå Image manquante: $img_path dans $md_file"
            missing_images=$((missing_images + 1))
        fi
    done
done

# V√©rification du front matter (si utilis√©)
echo "üìã Validation des m√©tadonn√©es..."
for md_file in $(find docs/ -name "*.md"); do
    if head -n 1 "$md_file" | grep -q "^---$"; then
        # V√©rifier que le front matter est bien ferm√©
        if ! sed -n '2,/^---$/p' "$md_file" | tail -n 1 | grep -q "^---$"; then
            echo "‚ùå Front matter mal form√© dans: $md_file"
            exit 1
        fi
    fi
done

echo "‚úÖ Validation termin√©e avec succ√®s !"
````

</TabItem>
</Tabs>

### 4.3 Templates et Standards d'√âquipe

<Tabs>
<TabItem value="template-guide" label="Template Guide Technique">

````markdown
---
title: '[Nom du Guide]'
description: 'Description concise du contenu'
author: '[Nom Auteur]'
date: 'YYYY-MM-DD'
version: 'X.Y'
tags: ['tag1', 'tag2', 'tag3']
difficulty: 'D√©butant|Interm√©diaire|Avanc√©'
estimated_time: 'XX minutes'
---

# [Titre du Guide]

:::note Informations
**‚è±Ô∏è Temps estim√© :** XX minutes  
**üìö Niveau :** [D√©butant/Interm√©diaire/Avanc√©]  
**üéØ Objectif :** [Objectif principal en une phrase]
:::

## üìã Pr√©requis

-   [ ] [Pr√©requis technique 1]
-   [ ] [Pr√©requis technique 2]
-   [ ] [Connaissances requises]

## üéØ Objectifs d'Apprentissage

√Ä la fin de ce guide, vous saurez :

1. [Objectif sp√©cifique 1]
2. [Objectif sp√©cifique 2]
3. [Objectif sp√©cifique 3]

## 1. [Section Principale 1] <Badge niveau="[Niveau]" />

### 1.1 [Sous-section avec Explication]

[Contenu explicatif avec exemples]

<Tabs>
<TabItem value="exemple" label="Exemple Pratique">

```[language]
// Code d'exemple comment√©
[code snippet]
```
````

</TabItem>
<TabItem value="resultat" label="R√©sultat Attendu">

[Description du r√©sultat]

</TabItem>
</Tabs>

:::tip Bonne Pratique
[Conseil ou astuce pertinente]
:::

### 1.2 [Sous-section Suivante]

[Suite du contenu...]

## 2. [Section Principale 2] <Badge niveau="[Niveau]" />

[Contenu de la section...]

## üèãÔ∏è Exercice Pratique

:::note √ânonc√©
[Description claire de l'exercice √† r√©aliser]
:::

<Tabs>
<TabItem value="exercice" label="üìù √Ä Vous de Jouer">

[Instructions d√©taill√©es]

</TabItem>
<TabItem value="solution" label="‚úÖ Solution">

```[language]
// Solution comment√©e
[code solution]
```

[Explication de la solution]

</TabItem>
<TabItem value="evaluation" label="üìä Crit√®res d'√âvaluation">

**Points √† v√©rifier :**

-   [ ] [Crit√®re 1]
-   [ ] [Crit√®re 2]
-   [ ] [Crit√®re 3]

</TabItem>
</Tabs>

## üîó Ressources Compl√©mentaires

### Documentation Officielle

-   [Lien 1](url) - Description
-   [Lien 2](url) - Description

### Outils Recommand√©s

-   **[Nom Outil]** - [Description et usage]
-   **[Nom Outil]** - [Description et usage]

### Articles et Tutoriels

-   [Article pertinent](url) - R√©sum√©
-   [Tutoriel avanc√©](url) - R√©sum√©

## ‚û°Ô∏è Prochaines √âtapes

1. **[√âtape suivante recommand√©e]** - [lien vers guide]
2. **[Approfondissement]** - [lien vers ressource]
3. **[Cas d'usage avanc√©]** - [lien vers guide expert]

---

:::info M√©tadonn√©es

-   **üìù Derni√®re mise √† jour :** [Date]
-   **üë• Contributeurs :** [Liste]
-   **üîÑ Version :** [Num√©ro version]
-   **üìã Statut :** [Brouillon/Review/Publi√©]
    :::

```markdown
---
title: '[Nom API] Documentation'
description: "Documentation compl√®te de l'API [Nom]"
version: 'v1.2.3'
base_url: 'https://api.example.com/v1'
date: '2025-06-20'
---
```

# [Nom API] - Documentation

:::note Informations API
**üåê URL de base :** `https://api.example.com/v1`
**üìä Version :** v1.2.3
**üîí Authentification :** Bearer Token (JWT)
**üìã Format :** JSON
**‚ö° Rate Limit :** 1000 req/hour
:::

## üöÄ Quick Start

### Installation

<Tabs>
<TabItem value="curl" label="cURL">

```bash
# Test de base de l'API
curl -H "Authorization: Bearer YOUR_TOKEN" \
     https://api.example.com/v1/status
```

</TabItem>
<TabItem value="javascript" label="JavaScript">

```javascript
// Configuration client API
const API_BASE = 'https://api.example.com/v1';
const headers = {
    Authorization: 'Bearer YOUR_TOKEN',
    'Content-Type': 'application/json',
};

// Test de connexion
fetch(`${API_BASE}/status`, { headers })
    .then((response) => response.json())
    .then((data) => console.log(data));
```

</TabItem>
<TabItem value="python" label="Python">

```python
import requests

# Configuration
API_BASE = "https://api.example.com/v1"
headers = {
    "Authorization": "Bearer YOUR_TOKEN",
    "Content-Type": "application/json"
}

# Test de connexion
response = requests.get(f"{API_BASE}/status", headers=headers)
print(response.json())
```

</TabItem>
</Tabs>

## üîê Authentification

### Obtenir un Token

**Endpoint :** `POST /auth/login`

**Param√®tres :**

| Param√®tre     | Type    | Requis | Description                         |
| ------------- | ------- | :----: | ----------------------------------- |
| `email`       | string  |   ‚úÖ   | Email de l'utilisateur              |
| `password`    | string  |   ‚úÖ   | Mot de passe                        |
| `remember_me` | boolean |   ‚ùå   | Session persistante (d√©faut: false) |

**Exemple de requ√™te :**

```bash
curl -X POST https://api.example.com/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "securepassword",
    "remember_me": true
  }'
```

**R√©ponse (200 OK) :**

```json
{
    "status": "success",
    "data": {
        "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
        "token_type": "Bearer",
        "expires_in": 3600,
        "user": {
            "id": 123,
            "email": "user@example.com",
            "role": "user"
        }
    }
}
```

### Utilisation du Token

Inclure le token dans l'header `Authorization` de toutes les requ√™tes :

```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

## üìö Endpoints

### Utilisateurs

#### GET /users - Lister les utilisateurs

**Description :** R√©cup√®re la liste pagin√©e des utilisateurs.

**Param√®tres de requ√™te :**

| Param√®tre | Type    | D√©faut | Description                               |
| --------- | ------- | ------ | ----------------------------------------- |
| `page`    | integer | 1      | Num√©ro de page                            |
| `limit`   | integer | 20     | Nombre d'√©l√©ments par page (max: 100)     |
| `role`    | string  | -      | Filtrer par r√¥le (user, admin, moderator) |
| `search`  | string  | -      | Recherche par nom ou email                |

**Exemple :**

```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  "https://api.example.com/v1/users?page=1&limit=10&role=user"
```

**R√©ponse (200 OK) :**

```json
{
    "status": "success",
    "data": {
        "users": [
            {
                "id": 1,
                "email": "john@example.com",
                "name": "John Doe",
                "role": "user",
                "created_at": "2024-01-15T10:30:00Z",
                "last_login": "2024-06-20T14:22:00Z"
            }
        ],
        "pagination": {
            "current_page": 1,
            "total_pages": 5,
            "total_items": 87,
            "items_per_page": 20
        }
    }
}
```

#### POST /users - Cr√©er un utilisateur

**Description :** Cr√©e un nouvel utilisateur.

**Body (JSON) :**

```json
{
    "email": "newuser@example.com",
    "name": "New User",
    "password": "securepassword",
    "role": "user"
}
```

**R√©ponse (201 Created) :**

```json
{
    "status": "success",
    "data": {
        "user": {
            "id": 124,
            "email": "newuser@example.com",
            "name": "New User",
            "role": "user",
            "created_at": "2024-06-20T15:30:00Z"
        }
    }
}
```

## ‚ö†Ô∏è Gestion des Erreurs

### Codes d'Erreur Standards

| Code | Statut                | Description                |
| ---- | --------------------- | -------------------------- |
| 400  | Bad Request           | Param√®tres invalides       |
| 401  | Unauthorized          | Token manquant ou invalide |
| 403  | Forbidden             | Permissions insuffisantes  |
| 404  | Not Found             | Ressource introuvable      |
| 422  | Unprocessable Entity  | Erreurs de validation      |
| 429  | Too Many Requests     | Rate limit d√©pass√©         |
| 500  | Internal Server Error | Erreur serveur             |

### Format des Erreurs

```json
{
    "status": "error",
    "error": {
        "code": "VALIDATION_ERROR",
        "message": "Les donn√©es fournies sont invalides",
        "details": {
            "email": ["L'email est requis"],
            "password": ["Le mot de passe doit contenir au moins 8 caract√®res"]
        }
    }
}
```

## üìä Rate Limiting

-   **Limite :** 1000 requ√™tes par heure par token
-   **Headers de r√©ponse :**
    -   `X-RateLimit-Limit`: Limite totale
    -   `X-RateLimit-Remaining`: Requ√™tes restantes
    -   `X-RateLimit-Reset`: Timestamp de reset

**Exemple de headers :**

```
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 987
X-RateLimit-Reset: 1640995200
```

## üß™ Environnements de Test

### Sandbox

**URL :** `https://api-sandbox.example.com/v1`  
**Authentification :** Token de test fourni  
**Donn√©es :** Dataset de test r√©initialis√© quotidiennement

### Postman Collection

[![Run in Postman](https://run.pstmn.io/button.svg)](https://app.getpostman.com/run-collection/your-collection-id)

## üìû Support et Contact

-   **üìß Support technique :** api-support@example.com
-   **üìö Documentation :** https://docs.example.com
-   **üêõ Bug reports :** https://github.com/company/api/issues
-   **üí¨ Community :** https://discord.gg/company-api

---

:::info Informations Document

-   **üìù Derni√®re mise √† jour :** 20 juin 2025
-   **üë• Maintenu par :** √âquipe API
-   **üîÑ Version API :** v1.2.3
-   **üìã Statut :** Production stable
    :::

````

</TabItem>
</Tabs>

## 5. Cas Pratiques Interm√©diaires <Badge niveau="Interm√©diaire" />

### Cas Pratique 1 : Documentation de Module DevSecOps

:::note √ânonc√©
Cr√©ez la documentation compl√®te d'un module de **monitoring de s√©curit√©** incluant :

- **Table des mati√®res** avec navigation
- **Tableaux de configuration** avec alignements appropri√©s
- **Blocs de code** pour diff√©rents langages (Bash, Python, YAML)
- **Blocs diff** montrant les am√©liorations de s√©curit√©
- **Mentions d'√©quipes** et r√©f√©rences d'issues
- **√âmojis** pour la communication claire
:::

<Tabs>
<TabItem value="enonce" label="üìù Votre Mission">

**Sp√©cifications du module :**
- **Nom :** SecurityMonitor
- **Fonction :** Surveillance en temps r√©el des tentatives d'intrusion
- **Technologies :** Python, Prometheus, Grafana, Docker
- **√âquipes :** @security-team, @devops-team, @monitoring-team

**Structure demand√©e :**
1. Introduction avec badges de statut
2. Configuration (tableau des param√®tres)
3. Installation (√©tapes avec code)
4. Am√©liorations r√©centes (blocs diff)
5. Alertes et notifications (√©mojis + mentions)
6. D√©pannage (FAQ)

</TabItem>
<TabItem value="solution" label="‚úÖ Solution Compl√®te">

```markdown
# SecurityMonitor - Module de Surveillance S√©curis√©e

[![Build Status](https://img.shields.io/github/workflow/status/company/security-monitor/CI)](https://github.com/company/security-monitor/actions)
[![Security Rating](https://img.shields.io/badge/security-A+-green.svg)](https://sonarcloud.io/dashboard?id=security-monitor)
[![Coverage](https://img.shields.io/codecov/c/github/company/security-monitor.svg)](https://codecov.io/gh/company/security-monitor)

## üìã Table des Mati√®res

1. [Vue d'ensemble](#vue-densemble)
2. [Configuration](#configuration)
3. [Installation](#installation)
4. [Am√©liorations v2.1](#am√©liorations-v21)
5. [Alertes et Notifications](#alertes-et-notifications)
6. [D√©pannage](#d√©pannage)

## Vue d'ensemble

Module Python de surveillance en temps r√©el des **tentatives d'intrusion** avec int√©gration Prometheus et alerting automatique.

**√âquipes responsables :**
- **D√©veloppement :** @security-team
- **Infrastructure :** @devops-team
- **Monitoring :** @monitoring-team

## Configuration

### Param√®tres Principaux

| Param√®tre | Type | D√©faut | Description | Env Variable |
|-----------|:----:|:------:|-------------|:------------:|
| `log_level` | string | `INFO` | Niveau de logs | `LOG_LEVEL` |
| `scan_interval` | integer | `30` | Intervalle scan (secondes) | `SCAN_INTERVAL` |
| `max_attempts` | integer | `5` | Tentatives max avant ban | `MAX_ATTEMPTS` |
| `ban_duration` | integer | `3600` | Dur√©e ban (secondes) | `BAN_DURATION` |
| `whitelist_ips` | array | `[]` | IPs exempt√©es | `WHITELIST_IPS` |
| `alert_webhook` | string | - | URL webhook Slack/Teams | `ALERT_WEBHOOK` |

### Sources de Donn√©es

| Source | Format | Localisation | Poids |
|--------|:------:|:------------:|:-----:|
| **Logs Apache** | Combined | `/var/log/apache2/access.log` | üü¢ √âlev√© |
| **Logs Nginx** | JSON | `/var/log/nginx/access.log` | üü¢ √âlev√© |
| **Logs SSH** | Syslog | `/var/log/auth.log` | üü° Moyen |
| **Fail2ban** | Custom | `/var/log/fail2ban.log` | üî¥ Critique |

## Installation

### Pr√©requis

```bash
# Installation des d√©pendances syst√®me
sudo apt update && sudo apt install -y \
  python3.9 \
  python3-pip \
  prometheus-node-exporter \
  fail2ban

# V√©rification des versions
python3 --version  # >= 3.9
pip3 --version     # >= 21.0
````

### Installation du Module

```bash
# Clonage du repository
git clone https://github.com/company/security-monitor.git
cd security-monitor

# Cr√©ation environnement virtuel
python3 -m venv venv
source venv/bin/activate

# Installation des d√©pendances Python
pip install -r requirements.txt

# Configuration
cp config.example.yaml config.yaml
# √âditer config.yaml selon vos besoins

# Tests d'installation
python -m pytest tests/ -v
```

### Configuration Docker

```yaml
# docker-compose.yml
version: '3.8'

services:
    security-monitor:
        image: company/security-monitor:latest
        container_name: security-monitor
        environment:
            - LOG_LEVEL=INFO
            - SCAN_INTERVAL=30
            - MAX_ATTEMPTS=5
        volumes:
            - /var/log:/var/log:ro
            - ./config.yaml:/app/config.yaml:ro
        ports:
            - '8080:8080' # M√©triques Prometheus
        depends_on:
            - prometheus
        restart: unless-stopped

    prometheus:
        image: prom/prometheus:latest
        ports:
            - '9090:9090'
        volumes:
            - ./prometheus.yml:/etc/prometheus/prometheus.yml:ro
```

## Am√©liorations v2.1

### Optimisation des Performances

```diff
# analyzer.py - Am√©lioration de l'analyse des patterns
class ThreatAnalyzer:
    def __init__(self):
-       self.patterns = {}
-       self.load_patterns_from_file()
+       self.patterns = PatternCache(ttl=3600)  # Cache avec TTL
+       self.ml_model = load_ml_detector()      # D√©tection IA

    def analyze_log_entry(self, entry):
-       # Analyse par regex simple
-       for pattern in self.patterns:
-           if re.match(pattern, entry):
-               return True
+       # Analyse hybride : regex + machine learning
+       if self.quick_pattern_match(entry):
+           return self.ml_model.predict_threat_probability(entry) > 0.8
        return False

+   def quick_pattern_match(self, entry):
+       """Pr√©-filtrage rapide avant analyse IA"""
+       return any(keyword in entry.lower() for keyword in self.threat_keywords)
```

### S√©curisation des Webhooks

```diff
# notifications.py - S√©curisation des webhooks
import hmac
import hashlib

def send_alert(webhook_url, payload):
-   # Envoi direct sans v√©rification
-   response = requests.post(webhook_url, json=payload)
+   # G√©n√©ration signature HMAC
+   secret = os.getenv('WEBHOOK_SECRET')
+   signature = hmac.new(
+       secret.encode(),
+       json.dumps(payload).encode(),
+       hashlib.sha256
+   ).hexdigest()
+
+   headers = {
+       'Content-Type': 'application/json',
+       'X-Signature': f'sha256={signature}',
+       'User-Agent': 'SecurityMonitor/2.1'
+   }
+
+   response = requests.post(webhook_url, json=payload, headers=headers, timeout=10)

    if response.status_code != 200:
        logger.error(f"Webhook failed: {response.status_code}")
```

### Configuration Rate Limiting

```diff
# config.yaml - Am√©lioration du rate limiting
rate_limiting:
-  enabled: false
+  enabled: true
+  rules:
+    - pattern: "login"
+      max_requests: 5
+      window: 300        # 5 minutes
+      action: "ban"
+    - pattern: "api"
+      max_requests: 100
+      window: 60         # 1 minute
+      action: "throttle"
+
+  actions:
+    ban:
+      duration: 3600     # 1 heure
+      notify: true
+    throttle:
+      delay: 1000        # 1 seconde
+      notify: false
```

## Alertes et Notifications

### Types d'Alertes

-   üö® **Critique** : Tentative d'intrusion d√©tect√©e (@security-team)
-   ‚ö†Ô∏è **Avertissement** : Seuil de tentatives atteint (@devops-team)
-   üìä **Information** : Rapport quotidien (@monitoring-team)
-   üîí **S√©curit√©** : Nouvelle r√®gle appliqu√©e (@security-team)

### Configuration Slack

```python
# notifications/slack.py
def send_security_alert(threat_level, details):
    """Envoi d'alerte s√©curit√© sur Slack avec mentions appropri√©es"""

    # D√©finition des mentions par niveau
    mentions = {
        'critical': '@security-team @devops-team',
        'warning': '@devops-team',
        'info': '@monitoring-team'
    }

    # √âmojis par niveau de menace
    emojis = {
        'critical': 'üö®',
        'warning': '‚ö†Ô∏è',
        'info': 'üìä'
    }

    message = f"""
{emojis[threat_level]} **Alerte S√©curit√© - {threat_level.upper()}**

**Source IP :** `{details['source_ip']}`
**Type d'attaque :** {details['attack_type']}
**Nombre de tentatives :** {details['attempts']}
**Timestamp :** {details['timestamp']}

**Action automatique :** {details['action_taken']}

{mentions[threat_level]} - Investigation requise

**Logs :** Voir Dashboard Grafana [ici](https://grafana.company.com/d/security)
"""

    return send_slack_message(message)
```

### Issues de Suivi

**Issues li√©es √† cette version :**

-   Am√©lioration performances : Closes #156
-   D√©tection IA : Implements #142
-   Webhooks s√©curis√©s : Fixes #189
-   Rate limiting : Resolves #201

**Pull Requests en cours :**

-   Int√©gration Elasticsearch : PR #67 (@alice-security)
-   Dashboard am√©lior√© : PR #68 (@bob-frontend)

## D√©pannage

### Probl√®mes Courants

#### üîç Module ne d√©marre pas

**Sympt√¥mes :** Erreur `ModuleNotFoundError`

**Solution :**

```bash
# V√©rifier l'environnement virtuel
source venv/bin/activate
pip list | grep -E "(prometheus|yaml|requests)"

# R√©installer si n√©cessaire
pip install --upgrade -r requirements.txt
```

#### ‚ö†Ô∏è Faux positifs d√©tect√©s

**Sympt√¥mes :** Bans d'IPs l√©gitimes

**Solution :**

1. Ajouter l'IP √† la whitelist
2. Ajuster les seuils dans `config.yaml`
3. V√©rifier les patterns de d√©tection

```bash
# D√©bannir une IP
sudo fail2ban-client set security-monitor unbanip 192.168.1.100

# V√©rifier les r√®gles actives
sudo fail2ban-client status security-monitor
```

#### üìä M√©triques Prometheus manquantes

**V√©rification :**

```bash
# Test endpoint m√©triques
curl http://localhost:8080/metrics | grep security_

# V√©rifier configuration Prometheus
prometheus_config_reloader --config.file=/etc/prometheus/prometheus.yml --dry-run
```

### Support et Escalade

**Niveaux de support :**

1. **L1 - Monitoring** (@monitoring-team) - Issues op√©rationnelles
2. **L2 - DevOps** (@devops-team) - Probl√®mes d'infrastructure
3. **L3 - Security** (@security-team) - Incidents de s√©curit√©

**Contacts d'urgence :**

-   üî¥ **Incident critique** : #security-incidents + @security-lead
-   üü° **Probl√®me syst√®me** : #devops-alerts + @devops-lead
-   üü¢ **Question g√©n√©rale** : #security-monitor-support

---

**Issues de r√©f√©rence :**

-   Configuration : Voir #123
-   Performance : Tracking #156
-   Documentation : Update #234

```

</TabItem>
<TabItem value="evaluation" label="üìä √âvaluation D√©taill√©e">

**Points forts de cette solution :**

‚úÖ **Structure professionnelle** avec navigation compl√®te
‚úÖ **Tableaux complexes** avec alignements et formatage appropri√©
‚úÖ **Code multi-langages** (Bash, Python, YAML) bien comment√©
‚úÖ **Blocs diff pertinents** montrant des am√©liorations r√©elles
‚úÖ **Mentions d'√©quipes** contextuelles et appropri√©es
‚úÖ **√âmojis professionnels** pour la communication claire
‚úÖ **R√©f√©rences issues/PR** int√©gr√©es naturellement
‚úÖ **Templates r√©utilisables** pour d'autres modules

**Score :** 19/20

**Axes d'am√©lioration mineurs :**
- Ajouter diagramme d'architecture (Mermaid)
- Inclure m√©triques de performance quantifi√©es

**Utilisation professionnelle :**
Cette documentation peut servir de **template** pour tous les modules de s√©curit√© de l'√©quipe.

</TabItem>
</Tabs>

---

## üéØ Points Cl√©s √† Retenir

:::tip R√©capitulatif Niveau Interm√©diaire
**Nouvelles comp√©tences acquises :**

- ‚úÖ **Tableaux professionnels** avec alignements et donn√©es complexes
- ‚úÖ **Blocs de code avanc√©s** avec coloration et commentaires d√©taill√©s
- ‚úÖ **Blocs diff** pour visualiser les modifications (+/-)
- ‚úÖ **Extensions GFM** : mentions, r√©f√©rences, √©mojis professionnels
- ‚úÖ **Organisation projet** : conventions, workflow Git, templates
- ‚úÖ **Documentation technique** compl√®te et structur√©e
:::

## ‚û°Ô∏è Prochaine √âtape

Excellent travail ! Vous ma√Ætrisez maintenant le **niveau interm√©diaire**.

Direction le **[niveau avanc√©](03-avance.md)** pour explorer :
- **MDX et composants React** pour l'interactivit√©
- **Diagrammes Mermaid** complexes et architectures
- **Automatisation** de la documentation (CI/CD, validation)
- **S√©curit√© avanc√©e** et bonnes pratiques DevSecOps
- **M√©tadonn√©es et SEO** pour la documentation professionnelle

---

:::info M√©tadonn√©es du Document
- **üìù Version :** 1.0
- **üìÖ Derni√®re mise √† jour :** Juin 2025
- **üë• Niveau :** <Badge niveau="Interm√©diaire" />
- **‚è±Ô∏è Dur√©e :** 45 minutes
- **üìö Pr√©requis :** [Fondamentaux Markdown](01-fondamentaux.md)
- **üéØ Objectif :** Utilisation professionnelle avanc√©e
:::
```
